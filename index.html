<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sentinel CRM</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üõ°Ô∏è</text></svg>" />
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
  <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'DM Sans', sans-serif; background: #0f172a; overflow: hidden; }
    #root { width: 100vw; height: 100vh; }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #334155; border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: #475569; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect, useCallback, useMemo } = React;

    // Inline SVG Icon Components - no external dependency needed
    const Icon = (props) => React.createElement('svg', {
      xmlns: 'http://www.w3.org/2000/svg', width: props.size || 24, height: props.size || 24,
      viewBox: '0 0 24 24', fill: 'none', stroke: props.color || 'currentColor',
      strokeWidth: 2, strokeLinecap: 'round', strokeLinejoin: 'round',
      style: props.style, className: props.className
    }, ...(props.children || []));
    const p = (d) => React.createElement('path', { d, key: d.slice(0,10) });
    const c = (cx,cy,r) => React.createElement('circle', { cx, cy, r, key: `c${cx}${cy}` });
    const l = (x1,y1,x2,y2) => React.createElement('line', { x1, y1, x2, y2, key: `l${x1}${y1}` });
    const r = (x,y,w,h,rx) => React.createElement('rect', { x, y, width:w, height:h, rx, key: `r${x}${y}` });
    const pl = (pts) => React.createElement('polyline', { points: pts, key: `pl${pts.slice(0,8)}` });

    const Search = (pr) => <Icon {...pr}>{[c(11,11,8), l(21,21,16.65,16.65)]}</Icon>;
    const Plus = (pr) => <Icon {...pr}>{[l(12,5,12,19), l(5,12,19,12)]}</Icon>;
    const Building2 = (pr) => <Icon {...pr}>{[p("M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"), p("M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"), p("M18 9h2a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-2"), p("M10 6h4"), p("M10 10h4"), p("M10 14h4"), p("M10 18h4")]}</Icon>;
    const Phone = (pr) => <Icon {...pr}>{[p("M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z")]}</Icon>;
    const Mail = (pr) => <Icon {...pr}>{[r(2,4,20,16,2), pl("2 4 12 13 22 4")]}</Icon>;
    const MapPin = (pr) => <Icon {...pr}>{[p("M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"), c(12,10,3)]}</Icon>;
    const Calendar = (pr) => <Icon {...pr}>{[r(3,4,18,18,2), l(16,2,16,6), l(8,2,8,6), l(3,10,21,10)]}</Icon>;
    const Clock = (pr) => <Icon {...pr}>{[c(12,12,10), pl("12 6 12 12 16 14")]}</Icon>;
    const ChevronRight = (pr) => <Icon {...pr}>{[pl("9 18 15 12 9 6")]}</Icon>;
    const ChevronLeft = (pr) => <Icon {...pr}>{[pl("15 18 9 12 15 6")]}</Icon>;
    const ArrowLeft = (pr) => <Icon {...pr}>{[l(19,12,5,12), pl("12 19 5 12 12 5")]}</Icon>;
    const Edit2 = (pr) => <Icon {...pr}>{[p("M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z")]}</Icon>;
    const Trash2 = (pr) => <Icon {...pr}>{[pl("3 6 5 6 21 6"), p("M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"), l(10,11,10,17), l(14,11,14,17)]}</Icon>;
    const CheckCircle = (pr) => <Icon {...pr}>{[p("M22 11.08V12a10 10 0 1 1-5.93-9.14"), pl("22 4 12 14.01 9 11.01")]}</Icon>;
    const Bell = (pr) => <Icon {...pr}>{[p("M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"), p("M13.73 21a2 2 0 0 1-3.46 0")]}</Icon>;
    const TrendingUp = (pr) => <Icon {...pr}>{[pl("23 6 13.5 15.5 8.5 10.5 1 18"), pl("17 6 23 6 23 12")]}</Icon>;
    const Users = (pr) => <Icon {...pr}>{[p("M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"), c(9,7,4), p("M23 21v-2a4 4 0 0 0-3-3.87"), p("M16 3.13a4 4 0 0 1 0 7.75")]}</Icon>;
    const Shield = (pr) => <Icon {...pr}>{[p("M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z")]}</Icon>;
    const X = (pr) => <Icon {...pr}>{[l(18,6,6,18), l(6,6,18,18)]}</Icon>;
    const Save = (pr) => <Icon {...pr}>{[p("M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"), pl("17 21 17 13 7 13 7 21"), pl("7 3 7 8 15 8")]}</Icon>;
    const MessageSquare = (pr) => <Icon {...pr}>{[p("M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z")]}</Icon>;
    const PhoneCall = (pr) => <Icon {...pr}>{[p("M15.05 5A5 5 0 0 1 19 8.95M15.05 1A9 9 0 0 1 23 8.94m-1 7.98v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z")]}</Icon>;
    const Send = (pr) => <Icon {...pr}>{[l(22,2,11,13), p("M22 2 15 22 11 13 2 9l20-7z")]}</Icon>;
    const BarChart3 = (pr) => <Icon {...pr}>{[l(18,20,18,10), l(12,20,12,4), l(6,20,6,14)]}</Icon>;
    const Download = (pr) => <Icon {...pr}>{[p("M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"), pl("7 10 12 15 17 10"), l(12,15,12,3)]}</Icon>;
    const Upload = (pr) => <Icon {...pr}>{[p("M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"), pl("17 8 12 3 7 8"), l(12,3,12,15)]}</Icon>;
    const Target = (pr) => <Icon {...pr}>{[c(12,12,10), c(12,12,6), c(12,12,2)]}</Icon>;
    const UserPlus = (pr) => <Icon {...pr}>{[p("M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"), c(8.5,7,4), l(20,8,20,14), l(23,11,17,11)]}</Icon>;
    const Zap = (pr) => <Icon {...pr}>{[p("M13 2 3 14h9l-1 8 10-12h-9l1-8z")]}</Icon>;
    const PieChart = (pr) => <Icon {...pr}>{[p("M21.21 15.89A10 10 0 1 1 8 2.83"), p("M22 12A10 10 0 0 0 12 2v10z")]}</Icon>;
    const Car = (pr) => <Icon {...pr}>{[p("M14 16H9m10 0h3v-3.15a1 1 0 0 0-.84-.99L16 11l-2.7-3.6a1 1 0 0 0-.8-.4H5.24a2 2 0 0 0-1.8 1.1l-.8 1.63A6 6 0 0 0 2 12.42V16h2"), c(6.5,16.5,2.5), c(16.5,16.5,2.5)]}</Icon>;
    const User = (pr) => <Icon {...pr}>{[p("M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"), c(12,7,4)]}</Icon>;

const STORAGE_KEY = "sentinel-crm-v2";
const COVERAGE_TYPES_COMMERCIAL = ["General Liability", "BOP", "Workers Comp", "Commercial Auto", "Umbrella", "Professional Liability", "Inland Marine", "Property", "Cyber", "EPLI", "Other"];
const COVERAGE_TYPES_PERSONAL = ["Auto", "Homeowners", "Renters", "Condo", "Umbrella", "Flood", "Motorcycle", "Boat/Watercraft", "Life", "Other"];
const CARRIERS = ["Allstate", "Hartford", "Travelers", "CNA", "Progressive Commercial", "EMPLOYERS", "AmTrust", "Nationwide", "Liberty Mutual", "Citizens", "Universal", "Slide", "Heritage", "Other"];
const CARRIER_SUGGESTIONS = ["Allstate", "Hartford", "Travelers", "CNA", "Progressive Commercial", "Progressive", "EMPLOYERS", "AmTrust", "Nationwide", "Liberty Mutual", "Citizens", "Universal", "Slide", "Heritage", "GEICO", "State Farm", "USAA", "Chubb", "Zurich", "Markel", "Hanover", "Auto-Owners", "Erie", "Safeco", "Foremost", "American Integrity", "Security First", "Tower Hill", "Federated National", "TypTap", "Openly", "SageSure", "Palomar", "Weston", "Florida Peninsula", "FCCI", "Guard", "Berkshire Hathaway", "Farmers", "Mercury"];
const ACTIVITY_TYPES = ["Phone Call", "Email", "In-Person Meeting", "Quote Sent", "Policy Review", "Renewal Follow-up", "Referral", "BNI Contact", "Cold Call", "Note"];
const INDUSTRIES = ["Restaurant/Food Service", "Retail", "Construction", "Healthcare", "Childcare", "Professional Services", "Real Estate", "Auto Services", "Pest Control", "Manufacturing", "Technology", "Cleaning Services", "Landscaping", "Salon/Barbershop", "Other"];
const INDUSTRY_SUGGESTIONS = ["Restaurant/Food Service", "Retail", "Construction", "Healthcare", "Childcare/Daycare", "Professional Services", "Real Estate", "Auto Services", "Pest Control", "Manufacturing", "Technology", "Cleaning Services", "Landscaping", "Salon/Barbershop", "Legal Services", "Accounting/Finance", "Fitness/Gym", "Plumbing/HVAC", "Electrical", "Roofing", "Trucking/Transportation", "Wholesale/Distribution", "Nonprofit", "Education", "Hospitality/Hotel", "Marine Services", "Agriculture", "Entertainment", "Staffing Agency", "Consulting", "Property Management", "Security Services", "Printing/Signage", "Veterinary", "Dental", "Photography/Video"];
const PIPELINE_STAGES = ["New Lead", "Contacted", "Quote Sent", "Follow-Up", "Negotiating", "Won", "Lost"];
const LEAD_SOURCES = ["BNI Referral", "Client Referral", "Walk-In", "Website", "Social Media", "Cold Call", "Allstate Lead", "Google", "Door-to-Door", "Networking Event", "Other"];
const LINE_TYPES = ["Personal", "Commercial"];
const DOC_TYPES = ["Dec Page", "Application", "Quote", "Endorsement", "Certificate of Insurance", "Loss Runs", "Audit", "Cancellation Notice", "Binder", "Signed Forms", "Photos", "Wind Mitigation", "4-Point Inspection", "Roof Report", "Other"];

const STAGE_COLORS = {
  "New Lead": { bg: "#1e3a5f", fg: "#7dd3fc" },
  "Contacted": { bg: "#1e293b", fg: "#94a3b8" },
  "Quote Sent": { bg: "#78350f", fg: "#fcd34d" },
  "Follow-Up": { bg: "#4c1d95", fg: "#c4b5fd" },
  "Negotiating": { bg: "#0c4a6e", fg: "#38bdf8" },
  "Won": { bg: "#14532d", fg: "#86efac" },
  "Lost": { bg: "#7f1d1d", fg: "#fca5a5" },
};

const NAV_ITEMS = [
  { key: "dashboard", label: "Dashboard", Icon: BarChart3 },
  { key: "clients", label: "Clients", Icon: Building2 },
  { key: "pipeline", label: "Pipeline", Icon: Target },
  { key: "calendar", label: "Calendar", Icon: Calendar },
  { key: "reports", label: "Reports", Icon: PieChart },
];

const EXPORT_ITEMS = [
  { key: "clients", label: "Clients", Icon: Building2 },
  { key: "policies", label: "Policies", Icon: Shield },
  { key: "renewals", label: "Upcoming Renewals", Icon: Calendar },
  { key: "prospects", label: "Sales Pipeline", Icon: Target },
  { key: "activities", label: "Activity Log", Icon: Clock },
];

const generateId = () => String(Date.now()) + "-" + Math.random().toString(36).substr(2, 9);
const formatDateShort = (d) => { if (!d) return ""; try { return new Date(d).toLocaleDateString("en-US", { month: "short", day: "numeric" }); } catch(e) { return ""; } };
const daysUntil = (d) => { if (!d) return Infinity; const now = new Date(); now.setHours(0,0,0,0); const t = new Date(d); t.setHours(0,0,0,0); return Math.ceil((t - now) / 86400000); };

// Helper: get full name from split fields (clients)
const getFullName = (c) => { if (!c) return ""; if (c.lineType === "Personal") { return [c.firstName, c.middleName, c.lastName].filter(Boolean).join(" ") || c.contactName || ""; } return c.businessName || ""; };
const getContactName = (c) => { if (!c) return ""; return [c.firstName, c.middleName, c.lastName].filter(Boolean).join(" ") || c.contactName || ""; };
const getFirstName = (c) => { if (!c) return ""; return c.firstName || (c.contactName || c.name || "").split(" ")[0] || ""; };
const getFullAddress = (c) => { if (!c) return ""; if (c.streetAddress) { return [c.streetAddress + (c.unit ? ", " + c.unit : ""), c.city, c.state, c.zipCode].filter(Boolean).join(", "); } return c.address || ""; };
const US_STATES = ["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY","DC"];

const toCSVSafe = (val) => { const str = String(val == null ? "" : val); return str.includes(",") || str.includes('"') || str.includes("\n") ? '"' + str.replace(/"/g, '""') + '"' : str; };

const defaultData = { clients: [], policies: [], activities: [], followUps: [], prospects: [] };


// Sub-components defined outside main component for clean hoisting
const FileIconSvg = ({ size }) => (
  <svg width={size || 14} height={size || 14} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
    <path d="M14.5 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V7.5L14.5 2z"/>
    <polyline points="14,2 14,8 20,8"/>
  </svg>
);

const getActivityIcon = (type) => {
  if (type === "Phone Call" || type === "Cold Call") return <PhoneCall size={14} />;
  if (type === "Email") return <Send size={14} />;
  if (type === "In-Person Meeting" || type === "BNI Contact") return <Users size={14} />;
  if (type === "Quote Sent") return <FileIconSvg size={14} />;
  return <MessageSquare size={14} />;
};

const RenewalBadge = ({ days }) => {
  let bg, color, text;
  const d = Number(days);
  if (d < 0) { bg = "#7f1d1d"; color = "#fca5a5"; text = String(Math.abs(d)) + "d overdue"; }
  else if (d <= 14) { bg = "#7f1d1d"; color = "#fca5a5"; text = String(d) + "d"; }
  else if (d <= 30) { bg = "#78350f"; color = "#fcd34d"; text = String(d) + "d"; }
  else if (d <= 60) { bg = "#1e3a5f"; color = "#7dd3fc"; text = String(d) + "d"; }
  else { bg = "#14532d"; color = "#86efac"; text = String(d) + "d"; }
  return <span style={{ background: bg, color: color, padding: "2px 8px", borderRadius: 4, fontSize: 11, fontWeight: 600 }}>{text}</span>;
};

const StageBadge = ({ stage }) => {
  const c = STAGE_COLORS[stage] || { bg: "#1e293b", fg: "#94a3b8" };
  return <span style={{ background: c.bg, color: c.fg, padding: "3px 10px", borderRadius: 6, fontSize: 11, fontWeight: 600 }}>{String(stage)}</span>;
};

const LineTypeBadge = ({ type }) => (
  <span style={{ display: "inline-flex", alignItems: "center", gap: 4, background: type === "Personal" ? "#1e293b" : "#1e3a5f", color: type === "Personal" ? "#94a3b8" : "#7dd3fc", padding: "2px 8px", borderRadius: 4, fontSize: 11, fontWeight: 600 }}>
    {type === "Personal" ? <Car size={10} /> : <Building2 size={10} />} {String(type)}
  </span>
);

const BarViz = ({ items, total, maxItems }) => (
  <div style={{ display: "grid", gap: 10 }}>
    {(items || []).slice(0, maxItems || 10).map(function(item, i) {
      const label = String(item[0]);
      const value = Number(item[1]) || 0;
      return (
        <div key={label}>
          <div style={{ display: "flex", justifyContent: "space-between", marginBottom: 4 }}>
            <span style={{ fontSize: 13, color: "#cbd5e1", fontWeight: 500 }}>{label}</span>
            <span style={{ fontSize: 13, color: "#f8fafc", fontWeight: 700 }}>{"$" + value.toLocaleString()}</span>
          </div>
          <div style={{ height: 8, borderRadius: 4, background: "#0f1724", overflow: "hidden" }}>
            <div style={{ height: "100%", borderRadius: 4, background: "hsl(" + String(210 + i * 25) + ", 70%, 55%)", width: (total > 0 ? String((value / total * 100)) : "0") + "%", transition: "width 0.4s" }} />
          </div>
        </div>
      );
    })}
  </div>
);


// === PASSWORD GATE ===
const AUTH_KEY = "sentinel-crm-auth";
const LOGO_SRC = "data:image/png;base64,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";

async function hashPassword(pw) {
  var enc = new TextEncoder().encode(pw);
  var buf = await crypto.subtle.digest("SHA-256", enc);
  return Array.from(new Uint8Array(buf)).map(function(b) { return b.toString(16).padStart(2, "0"); }).join("");
}

function PasswordGate(props) {
  const [authed, setAuthed] = useState(false);
  const [checking, setChecking] = useState(true);
  const [password, setPassword] = useState("");
  const [confirm, setConfirm] = useState("");
  const [error, setError] = useState("");
  const [isSetup, setIsSetup] = useState(false);

  useEffect(function() {
    var stored = localStorage.getItem(AUTH_KEY);
    if (!stored) { setIsSetup(true); setChecking(false); }
    else {
      var session = sessionStorage.getItem("sentinel-session");
      if (session === "active") { setAuthed(true); }
      setChecking(false);
    }
  }, []);

  var handleSetup = async function() {
    if (password.length < 4) { setError("Password must be at least 4 characters"); return; }
    if (password !== confirm) { setError("Passwords don't match"); return; }
    var hash = await hashPassword(password);
    localStorage.setItem(AUTH_KEY, hash);
    sessionStorage.setItem("sentinel-session", "active");
    setAuthed(true);
  };

  var handleLogin = async function() {
    var hash = await hashPassword(password);
    var stored = localStorage.getItem(AUTH_KEY);
    if (hash === stored) {
      sessionStorage.setItem("sentinel-session", "active");
      setAuthed(true);
      setError("");
    } else {
      setError("Incorrect password");
      setPassword("");
    }
  };

  var handleKey = function(e) { if (e.key === "Enter") { isSetup ? handleSetup() : handleLogin(); } };

  if (checking) return React.createElement("div", { style: { display: "flex", alignItems: "center", justifyContent: "center", height: "100vh", background: "#0f1724", color: "#94a3b8" } }, "Loading...");
  if (authed) return props.children;

  var gateStyles = {
    wrap: { display: "flex", alignItems: "center", justifyContent: "center", height: "100vh", background: "#0f1724", fontFamily: "'DM Sans', sans-serif" },
    card: { background: "#1a2436", borderRadius: 16, border: "1px solid #1e293b", padding: "40px 36px", width: "100%", maxWidth: 400, textAlign: "center", boxShadow: "0 20px 60px rgba(0,0,0,0.5)" },
    logo: { height: 56, marginBottom: 20 },
    title: { fontSize: 18, fontWeight: 700, color: "#f8fafc", marginBottom: 6 },
    sub: { fontSize: 13, color: "#64748b", marginBottom: 24 },
    input: { width: "100%", padding: "12px 14px", borderRadius: 10, border: "1px solid #334155", background: "#0f1724", color: "#e2e8f0", fontSize: 14, outline: "none", boxSizing: "border-box", marginBottom: 12 },
    btn: { width: "100%", padding: "12px 16px", borderRadius: 10, border: "none", background: "#1d4ed8", color: "#fff", fontSize: 14, fontWeight: 600, cursor: "pointer", marginTop: 4 },
    err: { fontSize: 12, color: "#f87171", marginBottom: 8 },
    lock: { fontSize: 36, marginBottom: 12 }
  };

  if (isSetup) {
    return React.createElement("div", { style: gateStyles.wrap },
      React.createElement("div", { style: gateStyles.card },
        React.createElement("img", { src: LOGO_SRC, alt: "Sentinel Insurance", style: gateStyles.logo }),
        React.createElement("div", { style: gateStyles.lock }, "\u{1F512}"),
        React.createElement("div", { style: gateStyles.title }, "Set Up Password"),
        React.createElement("div", { style: gateStyles.sub }, "Protect your CRM data with a password"),
        error && React.createElement("div", { style: gateStyles.err }, error),
        React.createElement("input", { style: gateStyles.input, type: "password", placeholder: "Create password", value: password, onChange: function(e) { setPassword(e.target.value); setError(""); }, onKeyDown: handleKey }),
        React.createElement("input", { style: gateStyles.input, type: "password", placeholder: "Confirm password", value: confirm, onChange: function(e) { setConfirm(e.target.value); setError(""); }, onKeyDown: handleKey }),
        React.createElement("button", { style: gateStyles.btn, onClick: handleSetup }, "Set Password & Enter")
      )
    );
  }

  return React.createElement("div", { style: gateStyles.wrap },
    React.createElement("div", { style: gateStyles.card },
      React.createElement("img", { src: LOGO_SRC, alt: "Sentinel Insurance", style: gateStyles.logo }),
      React.createElement("div", { style: gateStyles.lock }, "\u{1F512}"),
      React.createElement("div", { style: gateStyles.title }, "Sentinel CRM"),
      React.createElement("div", { style: gateStyles.sub }, "Enter your password to continue"),
      error && React.createElement("div", { style: gateStyles.err }, error),
      React.createElement("input", { style: gateStyles.input, type: "password", placeholder: "Password", value: password, autoFocus: true, onChange: function(e) { setPassword(e.target.value); setError(""); }, onKeyDown: handleKey }),
      React.createElement("button", { style: gateStyles.btn, onClick: handleLogin }, "Unlock")
    )
  );
}

function SentinelCRM() {
  const [data, setData] = useState(defaultData);
  const [loading, setLoading] = useState(true);
  const [view, setView] = useState("dashboard");
  const [selectedClientId, setSelectedClientId] = useState(null);
  const [selectedProspectId, setSelectedProspectId] = useState(null);
  const [searchTerm, setSearchTerm] = useState("");
  const [modal, setModal] = useState(null);
  const [editItem, setEditItem] = useState(null);
  const [filterIndustry, setFilterIndustry] = useState("all");
  const [calendarMonth, setCalendarMonth] = useState(function() { const n = new Date(); return new Date(n.getFullYear(), n.getMonth(), 1); });
  const [pipelineFilter, setPipelineFilter] = useState("all");
  const [pipelineLineFilter, setPipelineLineFilter] = useState("all");
  const [reportView, setReportView] = useState("carrier");
  const [toast, setToast] = useState(null);
  const [emailMenuFor, setEmailMenuFor] = useState(null);

  useEffect(function() {
    (async function() {
      try {
        const r = await window.storage.get(STORAGE_KEY);
        if (r && r.value) {
          const parsed = JSON.parse(r.value);
          setData({
            clients: Array.isArray(parsed.clients) ? parsed.clients : [],
            policies: Array.isArray(parsed.policies) ? parsed.policies : [],
            activities: Array.isArray(parsed.activities) ? parsed.activities : [],
            followUps: Array.isArray(parsed.followUps) ? parsed.followUps : [],
            prospects: Array.isArray(parsed.prospects) ? parsed.prospects : [],
          });
        }
      } catch(e) { console.error("Load error", e); }
      setLoading(false);
    })();
  }, []);

  const saveData = useCallback(async function(nd) {
    setData(nd);
    try { await window.storage.set(STORAGE_KEY, JSON.stringify(nd)); } catch(e) { console.error("Save failed", e); }
  }, []);

  const showToast = function(msg) { setToast(String(msg)); setTimeout(function() { setToast(null); }, 2500); };

  // CLIENT OPS
  const addClient = function(c) { const nc = { ...c, id: generateId(), createdAt: new Date().toISOString() }; saveData({ ...data, clients: [...data.clients, nc] }); setModal(null); setSelectedClientId(nc.id); setView("client-detail"); showToast("Client added"); };
  const updateClient = function(c) { saveData({ ...data, clients: data.clients.map(function(x) { return x.id === c.id ? c : x; }) }); setModal(null); setEditItem(null); showToast("Client updated"); };
  const deleteClient = function(id) { if (!confirm("Delete this client and all associated data?")) return; saveData({ clients: data.clients.filter(function(c) { return c.id !== id; }), policies: data.policies.filter(function(p) { return p.clientId !== id; }), activities: data.activities.filter(function(a) { return a.clientId !== id; }), followUps: data.followUps.filter(function(f) { return f.clientId !== id; }), prospects: data.prospects }); setSelectedClientId(null); setView("clients"); showToast("Client deleted"); };

  // POLICY OPS
  const addPolicy = function(p) { saveData({ ...data, policies: [...data.policies, { ...p, id: generateId() }] }); setModal(null); showToast("Policy added"); };
  const updatePolicy = function(p) { saveData({ ...data, policies: data.policies.map(function(x) { return x.id === p.id ? p : x; }) }); setModal(null); setEditItem(null); showToast("Policy updated"); };
  const deletePolicy = function(id) { if (!confirm("Delete this policy?")) return; saveData({ ...data, policies: data.policies.filter(function(p) { return p.id !== id; }) }); };

  // ACTIVITY OPS
  const addActivity = function(a) { saveData({ ...data, activities: [...data.activities, { ...a, id: generateId(), date: a.date || new Date().toISOString() }] }); setModal(null); showToast("Activity logged"); };

  // FOLLOWUP OPS
  const addFollowUp = function(f) { saveData({ ...data, followUps: [...data.followUps, { ...f, id: generateId(), completed: false }] }); setModal(null); showToast("Follow-up added"); };
  const toggleFollowUp = function(id) { saveData({ ...data, followUps: data.followUps.map(function(f) { return f.id === id ? { ...f, completed: !f.completed, completedDate: !f.completed ? new Date().toISOString() : null } : f; }) }); };
  const deleteFollowUp = function(id) { saveData({ ...data, followUps: data.followUps.filter(function(f) { return f.id !== id; }) }); };

  // Document tracking
  const addDocument = function(d) { saveData({ ...data, documents: [...(data.documents || []), { ...d, id: generateId(), dateAdded: new Date().toISOString() }] }); setModal(null); showToast("Document tracked"); };
  const deleteDocument = function(id) { if (!confirm("Remove this document record?")) return; saveData({ ...data, documents: (data.documents || []).filter(function(d) { return d.id !== id; }) }); };
  const clientDocuments = (data.documents || []).filter(function(d) { return d.clientId === selectedClientId; }).sort(function(a, b) { return new Date(b.dateAdded) - new Date(a.dateAdded); });

  // Renewal workflows
  const addRenewalWorkflow = function(policyId) {
    var pol = data.policies.find(function(p) { return p.id === policyId; });
    if (!pol || !pol.expirationDate) return;
    var exp = new Date(pol.expirationDate);
    var steps = [
      { day: 150, label: "Begin Marketing", desc: "Pull loss runs, review coverage, identify remarketing opportunities" },
      { day: 120, label: "Submit to Markets", desc: "Send applications to carriers for quotes" },
      { day: 90, label: "Review Quotes", desc: "Compare options, prepare renewal proposal" },
      { day: 60, label: "Present to Client", desc: "Review renewal options, discuss coverage changes" },
      { day: 30, label: "Bind Coverage", desc: "Finalize selection, request binding, issue certificates" },
      { day: 14, label: "Confirm Renewal", desc: "Verify policy issued, update records, deliver documents" }
    ].map(function(s) {
      var target = new Date(exp); target.setDate(target.getDate() - s.day);
      return { ...s, targetDate: target.toISOString().split("T")[0], completed: false, completedDate: null };
    });
    var wf = { id: generateId(), policyId: policyId, clientId: pol.clientId, expirationDate: pol.expirationDate, steps: steps, createdAt: new Date().toISOString() };
    saveData({ ...data, renewalWorkflows: [...(data.renewalWorkflows || []), wf] });
    showToast("Renewal workflow started");
  };
  const toggleWorkflowStep = function(wfId, stepIdx) {
    saveData({ ...data, renewalWorkflows: (data.renewalWorkflows || []).map(function(wf) {
      if (wf.id !== wfId) return wf;
      var newSteps = wf.steps.map(function(s, i) { return i === stepIdx ? { ...s, completed: !s.completed, completedDate: !s.completed ? new Date().toISOString() : null } : s; });
      return { ...wf, steps: newSteps };
    }) });
  };
  const clientWorkflows = (data.renewalWorkflows || []).filter(function(w) { return w.clientId === selectedClientId; });

  // PROSPECT OPS
  const addProspect = function(p) { const np = { ...p, id: generateId(), createdAt: new Date().toISOString() }; saveData({ ...data, prospects: [...data.prospects, np] }); setModal(null); showToast("Prospect added"); };
  const updateProspect = function(p) { saveData({ ...data, prospects: data.prospects.map(function(x) { return x.id === p.id ? p : x; }) }); setModal(null); setEditItem(null); showToast("Prospect updated"); };
  const deleteProspect = function(id) { if (!confirm("Delete this prospect?")) return; saveData({ ...data, prospects: data.prospects.filter(function(p) { return p.id !== id; }) }); setSelectedProspectId(null); };
  const convertProspect = function(prospect) {
    var pNameParts = (prospect.contactName || prospect.name || "").split(" "); const newClient = { id: generateId(), lineType: prospect.lineType || "Commercial", businessName: prospect.lineType === "Commercial" ? prospect.name : "", firstName: pNameParts[0] || "", middleName: pNameParts.length > 2 ? pNameParts.slice(1, -1).join(" ") : "", lastName: pNameParts.length > 1 ? pNameParts[pNameParts.length - 1] : "", contactName: prospect.contactName || prospect.name, phone: prospect.phone || "", email: prospect.email || "", streetAddress: "", unit: "", city: "", state: "FL", zipCode: "", address: prospect.address || "", industry: prospect.industry || "", notes: "Converted from prospect. Source: " + (prospect.source || "N/A") + ". " + (prospect.notes || ""), createdAt: new Date().toISOString() };
    const updatedProspect = { ...prospect, stage: "Won", convertedClientId: newClient.id, convertedDate: new Date().toISOString() };
    saveData({ ...data, clients: [...data.clients, newClient], prospects: data.prospects.map(function(p) { return p.id === prospect.id ? updatedProspect : p; }) });
    setSelectedProspectId(null); setSelectedClientId(newClient.id); setView("client-detail"); showToast("Prospect converted to client!");
  };

  // DERIVED DATA
  const selectedClient = data.clients.find(function(c) { return c.id === selectedClientId; });
  const selectedProspect = data.prospects.find(function(p) { return p.id === selectedProspectId; });
  const clientPolicies = data.policies.filter(function(p) { return p.clientId === selectedClientId; });
  const clientActivities = data.activities.filter(function(a) { return a.clientId === selectedClientId; }).sort(function(a, b) { return new Date(b.date) - new Date(a.date); });
  const clientFollowUps = data.followUps.filter(function(f) { return f.clientId === selectedClientId; }).sort(function(a, b) { if (a.completed !== b.completed) return a.completed ? 1 : -1; return new Date(a.dueDate) - new Date(b.dueDate); });
  const prospectActivities = data.activities.filter(function(a) { return a.prospectId === selectedProspectId; }).sort(function(a, b) { return new Date(b.date) - new Date(a.date); });

  const activePolicies = data.policies.filter(function(p) { return p.status === "active"; });
  const upcomingRenewals = activePolicies.filter(function(p) { return daysUntil(p.expirationDate) <= 90 && daysUntil(p.expirationDate) >= 0; }).sort(function(a, b) { return daysUntil(a.expirationDate) - daysUntil(b.expirationDate); });
  const overdueFollowUps = data.followUps.filter(function(f) { return !f.completed && daysUntil(f.dueDate) < 0; });
  const pendingFollowUps = data.followUps.filter(function(f) { return !f.completed && daysUntil(f.dueDate) >= 0 && daysUntil(f.dueDate) <= 7; });
  const totalPremium = activePolicies.reduce(function(sum, p) { return sum + (parseFloat(p.premium) || 0); }, 0);
  const activeProspects = data.prospects.filter(function(p) { return p.stage !== "Won" && p.stage !== "Lost"; });

  const filteredClients = data.clients.filter(function(c) {
    var displayName = c.lineType === "Personal" ? getContactName(c) : c.businessName;
    const ms = !searchTerm || c.businessName.toLowerCase().includes(searchTerm.toLowerCase()) || getContactName(c).toLowerCase().includes(searchTerm.toLowerCase());
    const mi = filterIndustry === "all" || c.industry === filterIndustry;
    return ms && mi;
  });

  const filteredProspects = useMemo(function() {
    let list = data.prospects;
    if (pipelineFilter !== "all") list = list.filter(function(p) { return p.stage === pipelineFilter; });
    if (pipelineLineFilter !== "all") list = list.filter(function(p) { return p.lineType === pipelineLineFilter; });
    if (searchTerm) list = list.filter(function(p) { return p.name.toLowerCase().includes(searchTerm.toLowerCase()) || (p.contactName || "").toLowerCase().includes(searchTerm.toLowerCase()); });
    return list;
  }, [data.prospects, pipelineFilter, pipelineLineFilter, searchTerm]);

  const premiumByCarrier = useMemo(function() {
    const map = {};
    activePolicies.forEach(function(p) { const k = p.carrier || "Unknown"; map[k] = (map[k] || 0) + (parseFloat(p.premium) || 0); });
    return Object.entries(map).sort(function(a, b) { return b[1] - a[1]; });
  }, [data.policies]);

  const premiumByCoverage = useMemo(function() {
    const map = {};
    activePolicies.forEach(function(p) { const k = p.coverageType || "Unknown"; map[k] = (map[k] || 0) + (parseFloat(p.premium) || 0); });
    return Object.entries(map).sort(function(a, b) { return b[1] - a[1]; });
  }, [data.policies]);

  const premiumByClient = useMemo(function() {
    const map = {};
    activePolicies.forEach(function(p) { const c = data.clients.find(function(cl) { return cl.id === p.clientId; }); const k = c ? getFullName(c) : "Unknown"; map[k] = (map[k] || 0) + (parseFloat(p.premium) || 0); });
    return Object.entries(map).sort(function(a, b) { return b[1] - a[1]; });
  }, [data.policies, data.clients]);

  const pipelineStats = useMemo(function() {
    const stats = {};
    PIPELINE_STAGES.forEach(function(st) { stats[st] = { count: 0, value: 0 }; });
    data.prospects.forEach(function(p) { if (stats[p.stage]) { stats[p.stage].count++; stats[p.stage].value += parseFloat(p.estimatedPremium) || 0; }});
    return stats;
  }, [data.prospects]);

  // CSV EXPORT
  const exportCSV = function(type) {
    let csv = "";
    if (type === "clients") {
      csv = "Type,Name,Contact,Phone,Email,Address,Industry,Active Policies,Total Premium,Notes\n";
      data.clients.forEach(function(c) {
        const pols = data.policies.filter(function(p) { return p.clientId === c.id && p.status === "active"; });
        const prem = pols.reduce(function(sum, p) { return sum + (parseFloat(p.premium) || 0); }, 0);
        csv += [c.lineType || "Commercial", c.lineType === "Personal" ? getContactName(c) : c.businessName, getContactName(c), c.phone, c.email, getFullAddress(c), c.industry, pols.length, prem, c.notes].map(toCSVSafe).join(",") + "\n";
      });
    } else if (type === "policies") {
      csv = "Client,Coverage Type,Carrier,Policy Number,Premium,Effective Date,Expiration Date,Status,Notes\n";
      data.policies.forEach(function(p) {
        const c = data.clients.find(function(cl) { return cl.id === p.clientId; });
        csv += [c ? getFullName(c) : "", p.coverageType, p.carrier, p.policyNumber, p.premium, p.effectiveDate, p.expirationDate, p.status, p.notes].map(toCSVSafe).join(",") + "\n";
      });
    } else if (type === "renewals") {
      csv = "Client,Coverage,Carrier,Policy #,Premium,Expiration,Days Until Renewal\n";
      upcomingRenewals.forEach(function(p) {
        const c = data.clients.find(function(cl) { return cl.id === p.clientId; });
        csv += [c ? getFullName(c) : "", p.coverageType, p.carrier, p.policyNumber, p.premium, p.expirationDate, daysUntil(p.expirationDate)].map(toCSVSafe).join(",") + "\n";
      });
    } else if (type === "prospects") {
      csv = "Name,Contact,Phone,Email,Line Type,Source,Stage,Est. Premium,Products,Notes\n";
      data.prospects.forEach(function(p) {
        csv += [p.name, p.contactName, p.phone, p.email, p.lineType, p.source, p.stage, p.estimatedPremium, (p.products || []).join("; "), p.notes].map(toCSVSafe).join(",") + "\n";
      });
    } else if (type === "activities") {
      csv = "Date,Type,Client/Prospect,Notes\n";
      var sortedActs = data.activities.slice().sort(function(a,b) { return new Date(b.date) - new Date(a.date); });
      sortedActs.forEach(function(a) {
        const c = data.clients.find(function(cl) { return cl.id === a.clientId; });
        const p = data.prospects.find(function(pr) { return pr.id === a.prospectId; });
        csv += [a.date, a.type, c ? getFullName(c) : (p ? p.name : ""), a.notes].map(toCSVSafe).join(",") + "\n";
      });
    }
    const blob = new Blob([csv], { type: "text/csv" });
    const url = URL.createObjectURL(blob);
    const link = document.createElement("a");
    link.href = url; link.download = "sentinel-" + type + "-" + new Date().toISOString().split("T")[0] + ".csv";
    link.click(); URL.revokeObjectURL(url);
    showToast(type + " exported");
  };

  // CSV IMPORT
  const importCSV = function(file, type) {
    const reader = new FileReader();
    reader.onload = function(e) {
      try {
        const text = e.target.result;
        const lines = text.split("\n").filter(function(l) { return l.trim(); });
        if (lines.length < 2) { showToast("File is empty or has no data rows"); return; }
        const headers = lines[0].split(",").map(function(h) { return h.trim().replace(/^"|"$/g, "").toLowerCase(); });
        var imported = 0;
        for (var i = 1; i < lines.length; i++) {
          var vals = [];
          var current = "";
          var inQuotes = false;
          for (var j = 0; j < lines[i].length; j++) {
            var ch = lines[i][j];
            if (ch === '"') { inQuotes = !inQuotes; }
            else if (ch === ',' && !inQuotes) { vals.push(current.trim()); current = ""; }
            else { current += ch; }
          }
          vals.push(current.trim());
          var row = {};
          headers.forEach(function(h, idx) { row[h] = vals[idx] || ""; });
          if (type === "clients") {
            var isPersonal = (row["type"] || row["line type"] || row["linetype"] || "Personal").toLowerCase().includes("personal");
            var fullName = row["name"] || row["full name"] || row["contact name"] || row["contact"] || "";
            var nameParts = fullName.split(" ");
            var nc = {
              id: generateId(),
              lineType: isPersonal ? "Personal" : "Commercial",
              businessName: isPersonal ? "" : (row["business name"] || row["business"] || row["company"] || fullName || ""),
              firstName: row["first name"] || row["firstname"] || nameParts[0] || "",
              middleName: row["middle name"] || row["middlename"] || (nameParts.length > 2 ? nameParts.slice(1, -1).join(" ") : ""),
              lastName: row["last name"] || row["lastname"] || (nameParts.length > 1 ? nameParts[nameParts.length - 1] : ""),
              contactName: fullName,
              phone: row["phone"] || row["phone number"] || "",
              email: row["email"] || row["email address"] || "",
              streetAddress: row["street address"] || row["street"] || row["address"] || "",
              unit: row["unit"] || row["apt"] || row["suite"] || "",
              city: row["city"] || "",
              state: row["state"] || "FL",
              zipCode: row["zip code"] || row["zip"] || row["zipcode"] || row["postal code"] || "",
              address: row["address"] || "",
              industry: row["industry"] || "",
              notes: row["notes"] || "",
              createdAt: new Date().toISOString()
            };
            if (nc.firstName || nc.businessName) { data.clients.push(nc); imported++; }
          } else if (type === "prospects") {
            var np = {
              id: generateId(),
              name: row["name"] || row["full name"] || row["business name"] || row["company"] || "",
              contactName: row["contact name"] || row["contact"] || row["contact person"] || "",
              phone: row["phone"] || row["phone number"] || "",
              email: row["email"] || row["email address"] || "",
              address: row["address"] || "",
              lineType: (row["type"] || row["line type"] || row["linetype"] || "Personal").toLowerCase().includes("commercial") ? "Commercial" : "Personal",
              source: row["source"] || row["lead source"] || "",
              stage: row["stage"] || "New Lead",
              industry: row["industry"] || "",
              estimatedPremium: row["estimated premium"] || row["premium"] || "",
              products: (row["products"] || "").split(";").map(function(s) { return s.trim(); }).filter(Boolean),
              notes: row["notes"] || "",
              createdAt: new Date().toISOString()
            };
            if (np.name) { data.prospects.push(np); imported++; }
          }
        }
        saveData({ ...data });
        showToast(imported + " " + type + " imported successfully!");
        setModal(null);
      } catch (err) {
        showToast("Import error: " + err.message);
      }
    };
    reader.readAsText(file);
  };

  // CALENDAR
  const calendarRenewals = useMemo(function() {
    const y = calendarMonth.getFullYear();
    const m = calendarMonth.getMonth();
    return activePolicies.filter(function(p) {
      if (!p.expirationDate) return false;
      const d = new Date(p.expirationDate);
      return d.getFullYear() === y && d.getMonth() === m;
    });
  }, [data.policies, calendarMonth]);

  const calendarFollowUps = useMemo(function() {
    const y = calendarMonth.getFullYear();
    const m = calendarMonth.getMonth();
    return data.followUps.filter(function(f) {
      if (!f.dueDate || f.completed) return false;
      const d = new Date(f.dueDate);
      return d.getFullYear() === y && d.getMonth() === m;
    });
  }, [data.followUps, calendarMonth]);

  if (loading) return <div style={{ display: "flex", alignItems: "center", justifyContent: "center", height: "100vh", background: "#0f1724", color: "#94a3b8" }}><p>{"Loading Sentinel CRM..."}</p></div>;

  // STYLES
  const st = {
    app: { fontFamily: "'DM Sans', 'Segoe UI', sans-serif", background: "#0f1724", color: "#e2e8f0", minHeight: "100vh", display: "flex", flexDirection: "column" },
    header: { background: "#141e30", borderBottom: "1px solid #1e293b", padding: "10px 20px", display: "flex", alignItems: "center", justifyContent: "space-between", position: "sticky", top: 0, zIndex: 50 },
    nav: { display: "flex", gap: 2, flexWrap: "wrap" },
    navBtn: function(active) { return { padding: "7px 14px", borderRadius: 8, border: "none", background: active ? "#1d4ed8" : "transparent", color: active ? "#fff" : "#94a3b8", cursor: "pointer", fontSize: 12, fontWeight: 500, transition: "all 0.15s", whiteSpace: "nowrap" }; },
    main: { flex: 1, padding: "16px 20px", maxWidth: 1280, width: "100%", margin: "0 auto", boxSizing: "border-box" },
    card: { background: "#1a2436", borderRadius: 12, border: "1px solid #1e293b", padding: 18, marginBottom: 14 },
    cardHeader: { display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 },
    cardTitle: { fontSize: 13, fontWeight: 600, color: "#cbd5e1", display: "flex", alignItems: "center", gap: 8 },
    statGrid: { display: "grid", gridTemplateColumns: "repeat(5, 1fr)", gap: 10, marginBottom: 16 },
    statBox: function(accent) { return { background: "#1a2436", borderRadius: 12, border: "1px solid #1e293b", padding: "14px 16px", borderLeft: "3px solid " + accent }; },
    statValue: { fontSize: 24, fontWeight: 700, color: "#f8fafc", marginBottom: 2 },
    statLabel: { fontSize: 11, color: "#64748b", fontWeight: 500 },
    btn: function(v) { return { padding: v === "sm" ? "5px 10px" : v === "xs" ? "3px 6px" : "9px 16px", borderRadius: v === "xs" ? 4 : 8, border: v === "outline" ? "1px solid #334155" : "none", background: v === "primary" ? "#1d4ed8" : v === "success" ? "#15803d" : v === "danger" ? "#991b1b" : v === "outline" ? "transparent" : "#1e293b", color: v === "primary" ? "#fff" : v === "success" ? "#bbf7d0" : v === "danger" ? "#fca5a5" : "#cbd5e1", cursor: "pointer", fontSize: v === "xs" ? 11 : v === "sm" ? 12 : 13, fontWeight: 500, display: "inline-flex", alignItems: "center", gap: 5, transition: "all 0.15s", whiteSpace: "nowrap" }; },
    input: { width: "100%", padding: "9px 12px", borderRadius: 8, border: "1px solid #334155", background: "#0f1724", color: "#e2e8f0", fontSize: 13, outline: "none", boxSizing: "border-box" },
    select: { width: "100%", padding: "9px 12px", borderRadius: 8, border: "1px solid #334155", background: "#0f1724", color: "#e2e8f0", fontSize: 13, outline: "none", boxSizing: "border-box" },
    label: { display: "block", fontSize: 11, fontWeight: 600, color: "#94a3b8", marginBottom: 5, textTransform: "uppercase", letterSpacing: "0.03em" },
    modal: { position: "fixed", inset: 0, background: "rgba(0,0,0,0.75)", display: "flex", alignItems: "center", justifyContent: "center", zIndex: 100, padding: 20 },
    modalContent: { background: "#1a2436", borderRadius: 16, border: "1px solid #1e293b", padding: 24, width: "100%", maxWidth: 560, maxHeight: "88vh", overflowY: "auto" },
    modalTitle: { margin: 0, fontSize: 17, fontWeight: 700, color: "#f8fafc" },
    th: { textAlign: "left", padding: "8px 10px", fontSize: 10, fontWeight: 700, color: "#64748b", textTransform: "uppercase", letterSpacing: "0.05em", borderBottom: "1px solid #1e293b" },
    td: { padding: "10px", fontSize: 13, color: "#cbd5e1", borderBottom: "1px solid rgba(30,41,59,0.08)" },
    row: { display: "flex", alignItems: "center", gap: 10, padding: "10px 12px", background: "#0f1724", borderRadius: 8, cursor: "pointer", transition: "background 0.1s" },
  };

  // MODAL FORMS
  const ModalWrap = function(props) {
    return (
      <div style={st.modal} onClick={function() { setModal(null); setEditItem(null); }}>
        <div style={st.modalContent} onClick={function(e) { e.stopPropagation(); }}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 18 }}>
            <h3 style={st.modalTitle}>{String(props.title)}</h3>
            <button onClick={function() { setModal(null); setEditItem(null); }} style={{ ...st.btn(), padding: 5, borderRadius: 6 }}><X size={16} /></button>
          </div>
          {props.children}
        </div>
      </div>
    );
  };

  const FormGrid = function(props) { return <div style={{ display: "grid", gridTemplateColumns: "repeat(" + String(props.cols || 2) + ", 1fr)", gap: 12 }}>{props.children}</div>; };
  const FormField = function(props) { return <div style={props.span ? { gridColumn: "span " + String(props.span) } : {}}><label style={st.label}>{String(props.label)}</label>{props.children}</div>; };
  const FormActions = function(props) { return <div style={{ marginTop: 16, display: "flex", gap: 8, justifyContent: "flex-end" }}>{props.children}</div>; };

  const ClientForm = function(props) {
    const client = props.client;
    const onSave = props.onSave;
    const [f, sF] = useState(client || { lineType: "Personal", businessName: "", firstName: "", middleName: "", lastName: "", contactName: "", phone: "", email: "", streetAddress: "", unit: "", city: "", state: "FL", zipCode: "", address: "", industry: "", notes: "" });
    var canSave = f.lineType === "Personal" ? (f.firstName && f.lastName) : (f.businessName && f.firstName && f.lastName);
    return (
      <ModalWrap title={client ? "Edit Client" : "New Client"}>
        <div style={{ display: "grid", gap: 12 }}>
          <FormField label="Client Type">
            <div style={{ display: "flex", gap: 6 }}>
              {LINE_TYPES.map(function(lt) { return <button key={lt} onClick={function() { sF({ ...f, lineType: lt }); }} style={{ flex: 1, padding: "8px 12px", borderRadius: 8, border: "1px solid", borderColor: f.lineType === lt ? "#3b82f6" : "#334155", background: f.lineType === lt ? "rgba(29,78,216,0.15)" : "transparent", color: f.lineType === lt ? "#93c5fd" : "#94a3b8", fontSize: 13, cursor: "pointer", fontWeight: 600 }}>{lt === "Personal" ? "\u{1F464} Personal" : "\u{1F3E2} Commercial"}</button>; })}
            </div>
          </FormField>
          {f.lineType === "Commercial" && <FormField label="Business Name *"><input style={st.input} value={f.businessName} onChange={function(e) { sF({ ...f, businessName: e.target.value }); }} placeholder="ABC Pest Control" /></FormField>}
          <FormGrid>
            <FormField label="First Name *"><input style={st.input} value={f.firstName} onChange={function(e) { sF({ ...f, firstName: e.target.value }); }} placeholder="Jane" /></FormField>
            <FormField label="Last Name *"><input style={st.input} value={f.lastName} onChange={function(e) { sF({ ...f, lastName: e.target.value }); }} placeholder="Doe" /></FormField>
          </FormGrid>
          <FormGrid cols={f.lineType === "Commercial" ? 2 : 1}>
            <FormField label="Middle Name"><input style={st.input} value={f.middleName} onChange={function(e) { sF({ ...f, middleName: e.target.value }); }} placeholder="Optional" /></FormField>
            {f.lineType === "Commercial" && <FormField label="Industry"><input style={st.input} list="industry-list" value={f.industry} onChange={function(e) { sF({ ...f, industry: e.target.value }); }} placeholder="Type or select..." /><datalist id="industry-list">{INDUSTRY_SUGGESTIONS.map(function(i) { return <option key={i} value={i} />; })}</datalist></FormField>}
          </FormGrid>
          <FormGrid>
            <FormField label="Phone"><input style={st.input} value={f.phone} onChange={function(e) { sF({ ...f, phone: e.target.value }); }} placeholder="(954) 555-0123" /></FormField>
            <FormField label="Email"><input style={st.input} value={f.email} onChange={function(e) { sF({ ...f, email: e.target.value }); }} placeholder="john@business.com" /></FormField>
          </FormGrid>
          <FormGrid cols={2}>
            <FormField label="Street Address"><input style={st.input} value={f.streetAddress} onChange={function(e) { sF({ ...f, streetAddress: e.target.value }); }} placeholder="123 Main St" /></FormField>
            <FormField label="Unit / Apt"><input style={st.input} value={f.unit} onChange={function(e) { sF({ ...f, unit: e.target.value }); }} placeholder="Suite 200" /></FormField>
          </FormGrid>
          <FormGrid cols={3}>
            <FormField label="City"><input style={st.input} value={f.city} onChange={function(e) { sF({ ...f, city: e.target.value }); }} placeholder="Fort Lauderdale" /></FormField>
            <FormField label="State"><select style={st.select} value={f.state} onChange={function(e) { sF({ ...f, state: e.target.value }); }}><option value="">{"Select..."}</option>{US_STATES.map(function(s) { return <option key={s} value={s}>{s}</option>; })}</select></FormField>
            <FormField label="Zip Code"><input style={st.input} value={f.zipCode} onChange={function(e) { sF({ ...f, zipCode: e.target.value }); }} placeholder="33301" /></FormField>
          </FormGrid>
          <FormField label="Notes"><textarea style={{ ...st.input, height: 60, resize: "vertical" }} value={f.notes} onChange={function(e) { sF({ ...f, notes: e.target.value }); }} /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (canSave) onSave(f); }} disabled={!canSave}><Save size={14} /> {client ? "Update" : "Add Client"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const PolicyForm = function(props) {
    const policy = props.policy;
    const clientId = props.clientId;
    const onSave = props.onSave;
    const [f, sF] = useState(policy || { clientId: clientId, policyNumber: "", carrier: "", coverageType: "", premium: "", effectiveDate: "", expirationDate: "", status: "active", notes: "" });
    return (
      <ModalWrap title={policy ? "Edit Policy" : "Add Policy"}>
        <div style={{ display: "grid", gap: 12 }}>
          <FormGrid>
            <FormField label="Coverage Type *">
              <select style={st.select} value={f.coverageType} onChange={function(e) { sF({ ...f, coverageType: e.target.value }); }}>
                <option value="">{"Select..."}</option>
                <optgroup label="Commercial">{COVERAGE_TYPES_COMMERCIAL.map(function(t) { return <option key={t} value={t}>{t}</option>; })}</optgroup>
                <optgroup label="Personal">{COVERAGE_TYPES_PERSONAL.map(function(t) { return <option key={t} value={t}>{t}</option>; })}</optgroup>
              </select>
            </FormField>
            <FormField label="Carrier *"><input style={st.input} list="carrier-list" value={f.carrier} onChange={function(e) { sF({ ...f, carrier: e.target.value }); }} placeholder="Type or select carrier..." /><datalist id="carrier-list">{CARRIER_SUGGESTIONS.map(function(c) { return <option key={c} value={c} />; })}</datalist></FormField>
          </FormGrid>
          <FormGrid>
            <FormField label="Policy Number"><input style={st.input} value={f.policyNumber} onChange={function(e) { sF({ ...f, policyNumber: e.target.value }); }} placeholder="POL-12345" /></FormField>
            <FormField label="Annual Premium"><input style={st.input} type="number" value={f.premium} onChange={function(e) { sF({ ...f, premium: e.target.value }); }} placeholder="5000" /></FormField>
          </FormGrid>
          <FormGrid>
            <FormField label="Effective Date"><input style={st.input} type="date" value={f.effectiveDate} onChange={function(e) { sF({ ...f, effectiveDate: e.target.value }); }} /></FormField>
            <FormField label="Expiration Date"><input style={st.input} type="date" value={f.expirationDate} onChange={function(e) { sF({ ...f, expirationDate: e.target.value }); }} /></FormField>
          </FormGrid>
          <FormField label="Status">
            <select style={st.select} value={f.status} onChange={function(e) { sF({ ...f, status: e.target.value }); }}>
              <option value="active">{"Active"}</option><option value="pending">{"Pending Renewal"}</option><option value="expired">{"Expired"}</option><option value="cancelled">{"Cancelled"}</option>
            </select>
          </FormField>
          <FormField label="Notes"><textarea style={{ ...st.input, height: 50, resize: "vertical" }} value={f.notes} onChange={function(e) { sF({ ...f, notes: e.target.value }); }} /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (f.coverageType && f.carrier) onSave(f); }}><Save size={14} /> {policy ? "Update" : "Add Policy"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const ActivityForm = function(props) {
    const [f, sF] = useState({ clientId: props.clientId, prospectId: props.prospectId, type: "Phone Call", notes: "", date: new Date().toISOString().split("T")[0] });
    return (
      <ModalWrap title="Log Activity">
        <div style={{ display: "grid", gap: 12 }}>
          <FormGrid>
            <FormField label="Type"><select style={st.select} value={f.type} onChange={function(e) { sF({ ...f, type: e.target.value }); }}>{ACTIVITY_TYPES.map(function(t) { return <option key={t} value={t}>{t}</option>; })}</select></FormField>
            <FormField label="Date"><input style={st.input} type="date" value={f.date} onChange={function(e) { sF({ ...f, date: e.target.value }); }} /></FormField>
          </FormGrid>
          <FormField label="Notes *"><textarea style={{ ...st.input, height: 80, resize: "vertical" }} value={f.notes} onChange={function(e) { sF({ ...f, notes: e.target.value }); }} placeholder="What happened? Key takeaways, next steps..." /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (f.notes) addActivity(f); }}><Save size={14} /> {"Log Activity"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const FollowUpForm = function(props) {
    const [f, sF] = useState({ clientId: props.clientId, dueDate: "", description: "" });
    return (
      <ModalWrap title="New Follow-Up">
        <div style={{ display: "grid", gap: 12 }}>
          <FormField label="Due Date *"><input style={st.input} type="date" value={f.dueDate} onChange={function(e) { sF({ ...f, dueDate: e.target.value }); }} /></FormField>
          <FormField label="Description *"><textarea style={{ ...st.input, height: 80, resize: "vertical" }} value={f.description} onChange={function(e) { sF({ ...f, description: e.target.value }); }} placeholder="Call to review renewal, send updated quote..." /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (f.dueDate && f.description) addFollowUp(f); }}><Save size={14} /> {"Add Follow-Up"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const DocumentForm = function(props) {
    const [f, sF] = useState({ clientId: props.clientId, policyId: "", docType: "", name: "", notes: "" });
    var cPolicies = data.policies.filter(function(p) { return p.clientId === props.clientId; });
    return (
      <ModalWrap title="Track Document">
        <div style={{ display: "grid", gap: 12 }}>
          <FormGrid>
            <FormField label="Document Type *"><select style={st.select} value={f.docType} onChange={function(e) { sF({ ...f, docType: e.target.value }); }}><option value="">{"Select..."}</option>{DOC_TYPES.map(function(t) { return <option key={t} value={t}>{t}</option>; })}</select></FormField>
            <FormField label="Linked Policy"><select style={st.select} value={f.policyId} onChange={function(e) { sF({ ...f, policyId: e.target.value }); }}><option value="">{"None"}</option>{cPolicies.map(function(p) { return <option key={p.id} value={p.id}>{p.coverageType + " - " + p.carrier}</option>; })}</select></FormField>
          </FormGrid>
          <FormField label="Document Name *"><input style={st.input} value={f.name} onChange={function(e) { sF({ ...f, name: e.target.value }); }} placeholder="2025 GL Dec Page" /></FormField>
          <FormField label="Notes"><textarea style={{ ...st.input, height: 60, resize: "vertical" }} value={f.notes} onChange={function(e) { sF({ ...f, notes: e.target.value }); }} placeholder="Location, reference number, etc." /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (f.docType && f.name) addDocument(f); }} disabled={!f.docType || !f.name}><Save size={14} /> {"Track Document"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const ProspectForm = function(props) {
    const prospect = props.prospect;
    const onSave = props.onSave;
    const [f, sF] = useState(prospect || { name: "", contactName: "", phone: "", email: "", address: "", lineType: "Personal", source: "", stage: "New Lead", industry: "", estimatedPremium: "", products: [], notes: "" });
    const toggleProduct = function(p) { sF({ ...f, products: (f.products || []).includes(p) ? f.products.filter(function(x) { return x !== p; }) : [...(f.products || []), p] }); };
    const productOptions = f.lineType === "Personal" ? COVERAGE_TYPES_PERSONAL : COVERAGE_TYPES_COMMERCIAL;
    return (
      <ModalWrap title={prospect ? "Edit Prospect" : "New Prospect"}>
        <div style={{ display: "grid", gap: 12 }}>
          <FormGrid>
            <FormField label="Line Type"><select style={st.select} value={f.lineType} onChange={function(e) { sF({ ...f, lineType: e.target.value, products: [] }); }}>{LINE_TYPES.map(function(t) { return <option key={t} value={t}>{t}</option>; })}</select></FormField>
            <FormField label="Lead Source"><select style={st.select} value={f.source} onChange={function(e) { sF({ ...f, source: e.target.value }); }}><option value="">{"Select..."}</option>{LEAD_SOURCES.map(function(l) { return <option key={l} value={l}>{l}</option>; })}</select></FormField>
          </FormGrid>
          <FormGrid>
            <FormField label={f.lineType === "Personal" ? "Full Name *" : "Business Name *"}><input style={st.input} value={f.name} onChange={function(e) { sF({ ...f, name: e.target.value }); }} placeholder={f.lineType === "Personal" ? "Jane Doe" : "ABC Corp"} /></FormField>
            {f.lineType === "Commercial" && <FormField label="Contact Person"><input style={st.input} value={f.contactName} onChange={function(e) { sF({ ...f, contactName: e.target.value }); }} /></FormField>}
            {f.lineType === "Personal" && <FormField label="Stage"><select style={st.select} value={f.stage} onChange={function(e) { sF({ ...f, stage: e.target.value }); }}>{PIPELINE_STAGES.map(function(s2) { return <option key={s2} value={s2}>{s2}</option>; })}</select></FormField>}
          </FormGrid>
          <FormGrid>
            <FormField label="Phone"><input style={st.input} value={f.phone} onChange={function(e) { sF({ ...f, phone: e.target.value }); }} placeholder="(954) 555-0123" /></FormField>
            <FormField label="Email"><input style={st.input} value={f.email} onChange={function(e) { sF({ ...f, email: e.target.value }); }} /></FormField>
          </FormGrid>
          <FormField label="Address"><input style={st.input} value={f.address} onChange={function(e) { sF({ ...f, address: e.target.value }); }} placeholder="Fort Lauderdale, FL" /></FormField>
          {f.lineType === "Commercial" && (
            <FormGrid>
              <FormField label="Industry"><input style={st.input} list="industry-list-p" value={f.industry} onChange={function(e) { sF({ ...f, industry: e.target.value }); }} placeholder="Type or select..." /><datalist id="industry-list-p">{INDUSTRY_SUGGESTIONS.map(function(i) { return <option key={i} value={i} />; })}</datalist></FormField>
              <FormField label="Stage"><select style={st.select} value={f.stage} onChange={function(e) { sF({ ...f, stage: e.target.value }); }}>{PIPELINE_STAGES.map(function(s2) { return <option key={s2} value={s2}>{s2}</option>; })}</select></FormField>
            </FormGrid>
          )}
          <FormField label="Estimated Annual Premium"><input style={st.input} type="number" value={f.estimatedPremium} onChange={function(e) { sF({ ...f, estimatedPremium: e.target.value }); }} placeholder="2500" /></FormField>
          <FormField label="Products Interested In">
            <div style={{ display: "flex", flexWrap: "wrap", gap: 6, marginTop: 4 }}>
              {productOptions.map(function(p) {
                const selected = (f.products || []).includes(p);
                return <button key={p} onClick={function() { toggleProduct(p); }} style={{ padding: "4px 10px", borderRadius: 6, border: "1px solid", borderColor: selected ? "#3b82f6" : "#334155", background: selected ? "rgba(29,78,216,0.12)" : "transparent", color: selected ? "#93c5fd" : "#94a3b8", fontSize: 12, cursor: "pointer" }}>{p}</button>;
              })}
            </div>
          </FormField>
          <FormField label="Notes"><textarea style={{ ...st.input, height: 60, resize: "vertical" }} value={f.notes} onChange={function(e) { sF({ ...f, notes: e.target.value }); }} placeholder="How did they find us? What are their needs?" /></FormField>
          <FormActions><button style={st.btn("primary")} onClick={function() { if (f.name) onSave(f); }} disabled={!f.name}><Save size={14} /> {prospect ? "Update" : "Add Prospect"}</button></FormActions>
        </div>
      </ModalWrap>
    );
  };

  const ExportModal = function() {
    return (
      <ModalWrap title="Export Data">
        <div style={{ display: "grid", gap: 10 }}>
          {EXPORT_ITEMS.map(function(item) {
            var desc = "";
            if (item.key === "clients") desc = String(data.clients.length) + " clients";
            else if (item.key === "policies") desc = String(data.policies.length) + " policies";
            else if (item.key === "renewals") desc = String(upcomingRenewals.length) + " within 90 days";
            else if (item.key === "prospects") desc = String(data.prospects.length) + " prospects";
            else if (item.key === "activities") desc = String(data.activities.length) + " activities";
            var IconComp = item.Icon;
            return (
              <button key={item.key} onClick={function() { exportCSV(item.key); }} style={{ ...st.row, cursor: "pointer", justifyContent: "space-between", border: "1px solid #1e293b" }}>
                <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
                  <span style={{ color: "#3b82f6" }}><IconComp size={16} /></span>
                  <div><div style={{ fontSize: 14, fontWeight: 600, color: "#e2e8f0" }}>{String(item.label)}</div><div style={{ fontSize: 11, color: "#64748b" }}>{desc}</div></div>
                </div>
                <Download size={16} color="#64748b" />
              </button>
            );
          })}
        </div>
      </ModalWrap>
    );
  };

  // IMPORT MODAL
  const ImportModal = function() {
    const [importType, setImportType] = useState("clients");
    const fileInputRef = React.createRef();
    return (
      <ModalWrap title="Import Data">
        <div style={{ display: "grid", gap: 16 }}>
          <div>
            <label style={st.label}>{"Import Type"}</label>
            <div style={{ display: "flex", gap: 6 }}>
              {[{k: "clients", l: "\u{1F464} Clients"}, {k: "prospects", l: "\u{1F3AF} Prospects"}].map(function(item) {
                return <button key={item.k} onClick={function() { setImportType(item.k); }} style={{ flex: 1, padding: "10px", borderRadius: 8, border: "1px solid", borderColor: importType === item.k ? "#3b82f6" : "#334155", background: importType === item.k ? "rgba(29,78,216,0.15)" : "transparent", color: importType === item.k ? "#93c5fd" : "#94a3b8", fontSize: 13, cursor: "pointer", fontWeight: 600 }}>{item.l}</button>;
              })}
            </div>
          </div>
          <div style={{ padding: 16, border: "1px dashed #334155", borderRadius: 10, textAlign: "center" }}>
            <input ref={fileInputRef} type="file" accept=".csv,.tsv,.txt" style={{ display: "none" }} onChange={function(e) { if (e.target.files[0]) importCSV(e.target.files[0], importType); }} />
            <div style={{ fontSize: 32, marginBottom: 8 }}>{"\u{1F4C1}"}</div>
            <button onClick={function() { fileInputRef.current && fileInputRef.current.click(); }} style={{ ...st.btn("primary"), fontSize: 14 }}>{"Choose CSV File"}</button>
            <div style={{ fontSize: 11, color: "#64748b", marginTop: 8 }}>{"Upload a .csv file with column headers"}</div>
          </div>
          <div style={{ background: "#0f172a", borderRadius: 8, padding: 12 }}>
            <div style={{ fontSize: 11, fontWeight: 600, color: "#94a3b8", marginBottom: 6 }}>{"Expected Columns"}</div>
            {importType === "clients" ? (
              <div style={{ fontSize: 11, color: "#64748b", lineHeight: 1.6 }}>{"Type, First Name, Last Name, Middle Name, Business Name, Phone, Email, Street Address, Unit, City, State, Zip Code, Industry, Notes"}<br />{"(Column order is flexible \u2014 headers are matched by name)"}</div>
            ) : (
              <div style={{ fontSize: 11, color: "#64748b", lineHeight: 1.6 }}>{"Name, Contact Name, Phone, Email, Address, Type, Source, Stage, Industry, Estimated Premium, Products, Notes"}<br />{"(Column order is flexible \u2014 headers are matched by name)"}</div>
            )}
          </div>
        </div>
      </ModalWrap>
    );
  };

  // EMAIL MENU
  const EmailMenu = function(props) {
    const entity = props.entity;
    const entityType = props.entityType;
    const position = props.position || {};
    if (!entity || !entity.email) return null;
    const name = getFirstName(entity) || entity.businessName || entity.name || "";
    const email = entity.email;
    
    var templates = [];
    if (entityType === "client") {
      templates = [
        { label: "Policy Review", desc: "Schedule annual review", subject: "Policy Review - Sentinel Insurance", body: "Hi " + name + ",\n\nI'd like to schedule a review of your current coverage to make sure everything is up to date.\n\nWould you have time this week for a quick call?" },
        { label: "Renewal Notice", desc: "Upcoming renewal reminder", subject: "Upcoming Renewal - Sentinel Insurance", body: "Hi " + name + ",\n\nThis is a friendly reminder that your policy is coming up for renewal soon. I'd like to review your coverage and discuss any updates.\n\nPlease let me know a good time to connect." },
        { label: "Thank You", desc: "Post-meeting follow up", subject: "Thank You - Sentinel Insurance", body: "Hi " + name + ",\n\nThank you for taking the time to meet with me. I appreciate your business and am here if you have any questions." },
        { label: "Custom Email", desc: "Blank email to " + name, subject: "", body: "" },
      ];
    } else {
      templates = [
        { label: "Introduction", desc: "Initial outreach", subject: "Insurance Quote - Sentinel Insurance", body: "Hi " + name + ",\n\nMy name is Alec Berizzi with Sentinel Insurance. I specialize in helping businesses like yours find the right coverage at competitive rates.\n\nI'd love to learn more about your insurance needs. Would you have 15 minutes for a quick call?" },
        { label: "Quote Follow-Up", desc: "Follow up on sent quote", subject: "Following Up - Sentinel Insurance", body: "Hi " + name + ",\n\nI wanted to follow up on the quote I sent over. Have you had a chance to review it? I'm happy to walk through the details or answer any questions." },
        { label: "Custom Email", desc: "Blank email to " + name, subject: "", body: "" },
      ];
    }

    return (
      <div style={{ position: "absolute", right: position.right || 0, top: position.top || "100%", marginTop: position.marginTop || 4, background: "#1a2436", border: "1px solid #334155", borderRadius: 10, padding: 6, minWidth: 220, zIndex: 60, boxShadow: "0 8px 24px rgba(0,0,0,0.4)" }}>
        <div style={{ padding: "6px 10px", fontSize: 10, color: "#64748b", fontWeight: 600, textTransform: "uppercase" }}>{"Email Templates"}</div>
        {templates.map(function(tpl) {
          var mailtoUrl = "mailto:" + email + "?subject=" + encodeURIComponent(tpl.subject || "") + "&body=" + encodeURIComponent(tpl.body || "");
          return (
            <a key={tpl.label} href={mailtoUrl} onClick={function(e) {
              e.stopPropagation();
              addActivity({ clientId: entityType === "client" ? entity.id : undefined, prospectId: entityType === "prospect" ? entity.id : undefined, type: "Email", notes: "Email: " + tpl.label + " to " + name, date: new Date().toISOString().split("T")[0] });
              setEmailMenuFor(null);
            }} style={{ display: "block", width: "100%", textAlign: "left", padding: "8px 10px", background: "transparent", border: "none", borderRadius: 6, cursor: "pointer", color: "#e2e8f0", textDecoration: "none" }}>
              <div style={{ fontSize: 13, fontWeight: 500 }}>{tpl.label}</div>
              <div style={{ fontSize: 11, color: "#64748b" }}>{tpl.desc}</div>
            </a>
          );
        })}
      </div>
    );
  };


    // === VIEWS ===

  const Dashboard = function() {
    return (
      <div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }}>
          <div><h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{"Dashboard"}</h2><p style={{ margin: "2px 0 0", fontSize: 12, color: "#64748b" }}>{"Sentinel Insurance \u2014 Service & Sales Overview"}</p></div>
          <div style={{ display: "flex", gap: 8 }}>
            <button style={st.btn("outline")} onClick={function() { setModal("import"); }}><Upload size={14} /> {"Import"}</button>
            <button style={st.btn("outline")} onClick={function() { setModal("export"); }}><Download size={14} /> {"Export"}</button>
            <button style={st.btn("primary")} onClick={function() { setModal("add-client"); }}><Plus size={14} /> {"Client"}</button>
            <button style={{ ...st.btn("primary"), background: "#15803d" }} onClick={function() { setModal("add-prospect"); }}><UserPlus size={14} /> {"Prospect"}</button>
          </div>
        </div>
        <div style={st.statGrid}>
          <div style={st.statBox("#3b82f6")}><div style={st.statValue}>{String(data.clients.length)}</div><div style={st.statLabel}>{"Clients"}</div></div>
          <div style={st.statBox("#10b981")}><div style={st.statValue}>{String(activePolicies.length)}</div><div style={st.statLabel}>{"Active Policies"}</div></div>
          <div style={st.statBox("#f59e0b")}><div style={st.statValue}>{"$" + totalPremium.toLocaleString()}</div><div style={st.statLabel}>{"Book Premium"}</div></div>
          <div style={st.statBox("#8b5cf6")}><div style={st.statValue}>{String(activeProspects.length)}</div><div style={st.statLabel}>{"Active Prospects"}</div></div>
          <div style={st.statBox(overdueFollowUps.length > 0 ? "#ef4444" : "#64748b")}><div style={{ ...st.statValue, color: overdueFollowUps.length > 0 ? "#fca5a5" : "#f8fafc" }}>{String(overdueFollowUps.length)}</div><div style={st.statLabel}>{"Overdue Tasks"}</div></div>
        </div>

        {data.prospects.length > 0 && (
          <div style={{ ...st.card, padding: 14 }}>
            <div style={{ ...st.cardTitle, marginBottom: 10 }}><Target size={16} color="#10b981" /> {"Pipeline Summary"}</div>
            <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
              {PIPELINE_STAGES.filter(function(s2) { return s2 !== "Won" && s2 !== "Lost"; }).map(function(s2) {
                var sc = STAGE_COLORS[s2] || {};
                return (
                  <div key={s2} style={{ flex: 1, minWidth: 120, background: "#0f1724", borderRadius: 8, padding: "10px 12px", textAlign: "center" }}>
                    <div style={{ fontSize: 20, fontWeight: 700, color: sc.fg || "#94a3b8" }}>{String(pipelineStats[s2] ? pipelineStats[s2].count : 0)}</div>
                    <div style={{ fontSize: 11, color: "#64748b" }}>{s2}</div>
                    {pipelineStats[s2] && pipelineStats[s2].value > 0 && <div style={{ fontSize: 11, color: "#94a3b8", marginTop: 2 }}>{"$" + pipelineStats[s2].value.toLocaleString()}</div>}
                  </div>
                );
              })}
            </div>
          </div>
        )}

        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 14 }}>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><Calendar size={16} color="#f59e0b" /> {"Upcoming Renewals"}</div></div>
            {upcomingRenewals.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 12 }}>{"No upcoming renewals"}</p> : (
              <div style={{ display: "grid", gap: 6 }}>
                {upcomingRenewals.slice(0, 8).map(function(p) {
                  var c = data.clients.find(function(cl) { return cl.id === p.clientId; });
                  return (
                    <div key={p.id} style={st.row} onClick={function() { setSelectedClientId(p.clientId); setView("client-detail"); }}>
                      <div style={{ flex: 1 }}><div style={{ fontSize: 13, fontWeight: 600, color: "#e2e8f0" }}>{c ? getFullName(c) : "Unknown"}</div><div style={{ fontSize: 11, color: "#64748b" }}>{String(p.coverageType) + " \xb7 " + String(p.carrier)}</div></div>
                      <span style={{ fontSize: 11, color: "#94a3b8", marginRight: 6 }}>{formatDateShort(p.expirationDate)}</span>
                      <RenewalBadge days={daysUntil(p.expirationDate)} />
                    </div>
                  );
                })}
              </div>
            )}
          </div>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><Bell size={16} color="#8b5cf6" /> {"Action Items"}</div></div>
            {overdueFollowUps.length === 0 && pendingFollowUps.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 12 }}>{"All caught up!"}</p> : (
              <div style={{ display: "grid", gap: 6 }}>
                {[...overdueFollowUps, ...pendingFollowUps].slice(0, 8).map(function(f) {
                  var c = data.clients.find(function(cl) { return cl.id === f.clientId; });
                  return (
                    <div key={f.id} style={{ ...st.row, cursor: "default" }}>
                      <button onClick={function() { toggleFollowUp(f.id); }} style={{ background: "none", border: "none", cursor: "pointer", color: "#64748b", padding: 0 }}><CheckCircle size={15} /></button>
                      <div style={{ flex: 1 }}><div style={{ fontSize: 13, color: "#e2e8f0" }}>{String(f.description)}</div><div style={{ fontSize: 11, color: "#64748b" }}>{(c ? getFullName(c) : "") + " \xb7 " + formatDateShort(f.dueDate)}</div></div>
                      <RenewalBadge days={daysUntil(f.dueDate)} />
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        </div>

        <div style={st.card}>
          <div style={st.cardHeader}><div style={st.cardTitle}><Clock size={16} color="#3b82f6" /> {"Recent Activity"}</div></div>
          {data.activities.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 12 }}>{"No activity yet"}</p> : (
            <div style={{ display: "grid", gap: 4 }}>
              {data.activities.slice().sort(function(a, b) { return new Date(b.date) - new Date(a.date); }).slice(0, 10).map(function(a) {
                var c = data.clients.find(function(cl) { return cl.id === a.clientId; });
                var p = data.prospects.find(function(pr) { return pr.id === a.prospectId; });
                var entityName = c ? getFullName(c) : (p ? p.name : "");
                var noteText = String(a.notes || "");
                return (
                  <div key={a.id} style={st.row} onClick={function() { if (a.clientId) { setSelectedClientId(a.clientId); setView("client-detail"); } else if (a.prospectId) { setSelectedProspectId(a.prospectId); setView("prospect-detail"); }}}>
                    <div style={{ color: "#64748b" }}>{getActivityIcon(a.type)}</div>
                    <div style={{ flex: 1 }}><span style={{ fontSize: 13, color: "#cbd5e1" }}><strong style={{ color: "#e2e8f0" }}>{entityName}</strong>{" \u2014 " + (noteText.length > 80 ? noteText.substring(0, 80) + "..." : noteText)}</span></div>
                    <span style={{ fontSize: 11, color: "#64748b", whiteSpace: "nowrap" }}>{formatDateShort(a.date)}</span>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      </div>
    );
  };

  const ClientsList = function() {
    return (
      <div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
          <h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{"Commercial Clients"}</h2>
          <div style={{ display: "flex", gap: 8 }}><button style={st.btn("outline")} onClick={function() { exportCSV("clients"); }}><Download size={14} /></button><button style={st.btn("primary")} onClick={function() { setModal("add-client"); }}><Plus size={14} /> {"New Client"}</button></div>
        </div>
        <div style={{ display: "flex", gap: 10, marginBottom: 14 }}>
          <div style={{ flex: 1, position: "relative" }}><Search size={15} style={{ position: "absolute", left: 11, top: 11, color: "#475569" }} /><input style={{ ...st.input, paddingLeft: 34 }} placeholder="Search clients..." value={searchTerm} onChange={function(e) { setSearchTerm(e.target.value); }} /></div>
          <select style={{ ...st.select, width: 180 }} value={filterIndustry} onChange={function(e) { setFilterIndustry(e.target.value); }}><option value="all">{"All Industries"}</option>{INDUSTRIES.map(function(i) { return <option key={i} value={i}>{i}</option>; })}</select>
        </div>
        {filteredClients.length === 0 ? (
          <div style={{ textAlign: "center", padding: 40, color: "#475569" }}><Building2 size={36} style={{ marginBottom: 10, opacity: 0.3 }} /><p style={{ fontSize: 14, fontWeight: 500 }}>{data.clients.length === 0 ? "No clients yet" : "No matches"}</p></div>
        ) : (
          <div style={{ display: "grid", gap: 6 }}>
            {filteredClients.map(function(client) {
              var pols = data.policies.filter(function(p) { return p.clientId === client.id && p.status === "active"; });
              var prem = pols.reduce(function(sum, p) { return sum + (parseFloat(p.premium) || 0); }, 0);
              var pfu = data.followUps.filter(function(f) { return f.clientId === client.id && !f.completed; });
              var nr = pols.filter(function(p) { return daysUntil(p.expirationDate) >= 0; }).sort(function(a, b) { return daysUntil(a.expirationDate) - daysUntil(b.expirationDate); })[0];
              return (
                <div key={client.id} style={{ ...st.card, marginBottom: 0, cursor: "pointer", padding: "14px 18px", display: "flex", alignItems: "center", justifyContent: "space-between" }}
                  onClick={function() { setSelectedClientId(client.id); setView("client-detail"); }}>
                  <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
                    <div style={{ width: 38, height: 38, borderRadius: 10, background: "rgba(29,78,216,0.08)", display: "flex", alignItems: "center", justifyContent: "center" }}><Building2 size={17} color="#3b82f6" /></div>
                    <div><div style={{ fontSize: 14, fontWeight: 600, color: "#f8fafc" }}>{String(client.lineType === "Personal" ? getContactName(client) : client.businessName)}</div><div style={{ fontSize: 12, color: "#64748b" }}>{String(client.lineType === "Personal" ? "" : getContactName(client))}{client.industry ? " \xb7 " + client.industry : ""}</div></div>
                  </div>
                  <div style={{ display: "flex", alignItems: "center", gap: 16 }}>
                    <div style={{ textAlign: "right" }}><div style={{ fontSize: 13, fontWeight: 600, color: "#e2e8f0" }}>{String(pols.length) + " pol" + (pols.length !== 1 ? "s" : "")}</div><div style={{ fontSize: 11, color: "#64748b" }}>{"$" + prem.toLocaleString() + "/yr"}</div></div>
                    {pfu.length > 0 && <span style={{ background: "#7f1d1d", color: "#fca5a5", padding: "2px 7px", borderRadius: 10, fontSize: 11, fontWeight: 600 }}>{String(pfu.length)}</span>}
                    {nr && <RenewalBadge days={daysUntil(nr.expirationDate)} />}
                    <ChevronRight size={15} color="#475569" />
                  </div>
                </div>
              );
            })}
          </div>
        )}
      </div>
    );
  };

  const ClientDetail = function() {
    if (!selectedClient) return null;
    var cp = clientPolicies;
    var totalClientPrem = cp.filter(function(p) { return p.status === "active"; }).reduce(function(sum, p) { return sum + (parseFloat(p.premium) || 0); }, 0);
    return (
      <div>
        <button onClick={function() { setView("clients"); setSelectedClientId(null); }} style={{ ...st.btn("outline"), marginBottom: 12, padding: "5px 12px" }}><ArrowLeft size={14} /> {"Back"}</button>
        <div style={{ ...st.card, display: "flex", justifyContent: "space-between", alignItems: "flex-start" }}>
          <div>
            <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
              <h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{String(selectedClient.lineType === "Personal" ? getContactName(selectedClient) : selectedClient.businessName)}</h2>
              <span style={{ fontSize: 12, color: selectedClient.lineType === "Personal" ? "#a78bfa" : "#34d399", background: selectedClient.lineType === "Personal" ? "rgba(139,92,246,0.1)" : "rgba(16,185,129,0.1)", padding: "2px 10px", borderRadius: 6 }}>{selectedClient.lineType === "Personal" ? "Personal" : "Commercial"}</span>
              {selectedClient.industry && <span style={{ fontSize: 12, color: "#3b82f6", background: "rgba(29,78,216,0.08)", padding: "2px 10px", borderRadius: 6 }}>{String(selectedClient.industry)}</span>}
            </div>
            <div style={{ display: "flex", gap: 14, marginTop: 8, flexWrap: "wrap", fontSize: 13, color: "#94a3b8" }}>
              {getContactName(selectedClient) && <span style={{ display: "flex", alignItems: "center", gap: 4 }}><User size={13} /> {String(getContactName(selectedClient))}</span>}
              {selectedClient.phone && <span style={{ display: "flex", alignItems: "center", gap: 4 }}><Phone size={13} /> {String(selectedClient.phone)}</span>}
              {selectedClient.email && <span style={{ display: "flex", alignItems: "center", gap: 4 }}><Mail size={13} /> {String(selectedClient.email)}</span>}
              {getFullAddress(selectedClient) && <span style={{ display: "flex", alignItems: "center", gap: 4 }}><MapPin size={13} /> {String(getFullAddress(selectedClient))}</span>}
            </div>
            {selectedClient.notes && <p style={{ marginTop: 8, fontSize: 13, color: "#64748b", lineHeight: 1.5 }}>{String(selectedClient.notes)}</p>}
            <div style={{ marginTop: 10, fontSize: 13, fontWeight: 600, color: "#10b981" }}>{"Total Book: $" + totalClientPrem.toLocaleString() + "/yr"}</div>
          </div>
          <div style={{ display: "flex", gap: 6, position: "relative" }}>
            {selectedClient.email && (
              <div style={{ position: "relative" }}>
                <button style={st.btn("primary")} onClick={function() { setEmailMenuFor(emailMenuFor === "client" ? null : "client"); }}><Mail size={14} /> {"Email"}</button>
                {emailMenuFor === "client" && <EmailMenu entity={selectedClient} entityType="client" position={{ right: 0, marginTop: 4 }} />}
              </div>
            )}
            <button style={st.btn("outline")} onClick={function() { setEditItem(selectedClient); setModal("edit-client"); }}><Edit2 size={14} /></button>
            <button style={{ ...st.btn("outline"), borderColor: "#7f1d1d" }} onClick={function() { deleteClient(selectedClient.id); }}><Trash2 size={14} color="#f87171" /></button>
          </div>
        </div>

        <div style={st.card}>
          <div style={st.cardHeader}><div style={st.cardTitle}><Shield size={16} color="#3b82f6" /> {"Policies (" + String(cp.length) + ")"}</div><button style={st.btn("primary")} onClick={function() { setModal("add-policy"); }}><Plus size={14} /> {"Add"}</button></div>
          {cp.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No policies yet"}</p> : (
            <div style={{ overflowX: "auto" }}>
              <table style={{ width: "100%", borderCollapse: "collapse" }}>
                <thead><tr><th style={st.th}>{"Coverage"}</th><th style={st.th}>{"Carrier"}</th><th style={st.th}>{"Policy #"}</th><th style={st.th}>{"Premium"}</th><th style={st.th}>{"Eff."}</th><th style={st.th}>{"Exp."}</th><th style={st.th}>{"Status"}</th><th style={st.th}>{""}</th></tr></thead>
                <tbody>
                  {cp.map(function(p) {
                    var statusBg = p.status === "active" ? "#14532d" : p.status === "pending" ? "#78350f" : "#1e293b";
                    var statusColor = p.status === "active" ? "#86efac" : p.status === "pending" ? "#fcd34d" : "#94a3b8";
                    return (
                      <tr key={p.id}>
                        <td style={{ ...st.td, fontWeight: 600 }}>{String(p.coverageType)}</td>
                        <td style={st.td}>{String(p.carrier)}</td>
                        <td style={{ ...st.td, fontFamily: "monospace", fontSize: 12 }}>{p.policyNumber || "\u2014"}</td>
                        <td style={st.td}>{"$" + parseFloat(p.premium || 0).toLocaleString()}</td>
                        <td style={st.td}>{formatDateShort(p.effectiveDate)}</td>
                        <td style={st.td}><span style={{ display: "flex", alignItems: "center", gap: 6 }}>{formatDateShort(p.expirationDate)} {p.status === "active" && p.expirationDate && <RenewalBadge days={daysUntil(p.expirationDate)} />}</span></td>
                        <td style={st.td}><span style={{ padding: "2px 8px", borderRadius: 4, fontSize: 11, fontWeight: 600, background: statusBg, color: statusColor }}>{String(p.status)}</span></td>
                        <td style={{ ...st.td, whiteSpace: "nowrap" }}><button onClick={function() { setEditItem(p); setModal("edit-policy"); }} style={st.btn("xs")}><Edit2 size={11} /></button>{" "}<button onClick={function() { deletePolicy(p.id); }} style={st.btn("xs")}><Trash2 size={11} color="#f87171" /></button></td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          )}
        </div>

        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 14 }}>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><Bell size={16} color="#f59e0b" /> {"Follow-Ups (" + String(clientFollowUps.filter(function(f) { return !f.completed; }).length) + ")"}</div><button style={st.btn("primary")} onClick={function() { setModal("add-followup"); }}><Plus size={14} /></button></div>
            {clientFollowUps.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No follow-ups"}</p> : (
              <div style={{ display: "grid", gap: 5 }}>
                {clientFollowUps.map(function(f) {
                  return (
                    <div key={f.id} style={{ display: "flex", alignItems: "flex-start", gap: 8, padding: "8px 10px", background: "#0f1724", borderRadius: 8, opacity: f.completed ? 0.4 : 1 }}>
                      <button onClick={function() { toggleFollowUp(f.id); }} style={{ background: "none", border: "none", cursor: "pointer", color: f.completed ? "#10b981" : "#475569", padding: 0, marginTop: 2 }}><CheckCircle size={15} /></button>
                      <div style={{ flex: 1 }}><div style={{ fontSize: 13, color: "#e2e8f0", textDecoration: f.completed ? "line-through" : "none" }}>{String(f.description)}</div><div style={{ fontSize: 11, color: "#64748b", marginTop: 1 }}>{formatDateShort(f.dueDate)} {!f.completed && <RenewalBadge days={daysUntil(f.dueDate)} />}</div></div>
                      <button onClick={function() { deleteFollowUp(f.id); }} style={{ background: "none", border: "none", cursor: "pointer", color: "#475569", padding: 0 }}><X size={13} /></button>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><Clock size={16} color="#8b5cf6" /> {"Activity (" + String(clientActivities.length) + ")"}</div><button style={st.btn("primary")} onClick={function() { setModal("add-activity-client"); }}><Plus size={14} /></button></div>
            {clientActivities.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No activity"}</p> : (
              <div style={{ display: "grid", gap: 5 }}>
                {clientActivities.slice(0, 15).map(function(a) {
                  return (
                    <div key={a.id} style={{ display: "flex", alignItems: "flex-start", gap: 8, padding: "8px 10px", background: "#0f1724", borderRadius: 8 }}>
                      <div style={{ color: "#64748b", marginTop: 2 }}>{getActivityIcon(a.type)}</div>
                      <div style={{ flex: 1 }}><div style={{ fontSize: 13, color: "#e2e8f0" }}>{String(a.notes)}</div><div style={{ fontSize: 11, color: "#64748b", marginTop: 1 }}>{String(a.type) + " \xb7 " + formatDateShort(a.date)}</div></div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        </div>

        <div style={st.card}>
          <div style={st.cardHeader}><div style={st.cardTitle}><Download size={16} color="#06b6d4" /> {"Documents (" + String(clientDocuments.length) + ")"}</div><button style={st.btn("primary")} onClick={function() { setModal("add-document"); }}><Plus size={14} /> {"Add"}</button></div>
          {clientDocuments.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No documents tracked yet"}</p> : (
            <div style={{ overflowX: "auto" }}>
              <table style={{ width: "100%", borderCollapse: "collapse" }}>
                <thead><tr><th style={st.th}>{"Type"}</th><th style={st.th}>{"Name"}</th><th style={st.th}>{"Policy"}</th><th style={st.th}>{"Date Added"}</th><th style={st.th}>{"Notes"}</th><th style={st.th}>{""}</th></tr></thead>
                <tbody>
                  {clientDocuments.map(function(d) {
                    var linkedPolicy = d.policyId ? data.policies.find(function(p) { return p.id === d.policyId; }) : null;
                    return (
                      <tr key={d.id}>
                        <td style={{ ...st.td }}><span style={{ padding: "2px 8px", borderRadius: 4, fontSize: 11, fontWeight: 600, background: "#164e63", color: "#67e8f9" }}>{String(d.docType)}</span></td>
                        <td style={{ ...st.td, fontWeight: 600 }}>{String(d.name)}</td>
                        <td style={st.td}>{linkedPolicy ? (linkedPolicy.coverageType + " - " + linkedPolicy.carrier) : "\u2014"}</td>
                        <td style={st.td}>{formatDateShort(d.dateAdded)}</td>
                        <td style={{ ...st.td, fontSize: 12, color: "#94a3b8" }}>{d.notes || "\u2014"}</td>
                        <td style={st.td}><button onClick={function() { deleteDocument(d.id); }} style={st.btn("xs")}><Trash2 size={11} color="#f87171" /></button></td>
                      </tr>
                    );
                  })}
                </tbody>
              </table>
            </div>
          )}
        </div>

        {selectedClient.lineType !== "Personal" && (
          <div style={st.card}>
            <div style={st.cardHeader}>
              <div style={st.cardTitle}><Target size={16} color="#f59e0b" /> {"Renewal Workflows"}</div>
              {clientPolicies.filter(function(p) { return p.status === "active" && p.expirationDate; }).length > 0 && (
                <div style={{ position: "relative" }}>
                  <button style={st.btn("primary")} onClick={function() { setModal("start-workflow"); }}><Zap size={14} /> {"Start Workflow"}</button>
                </div>
              )}
            </div>
            {clientWorkflows.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No active renewal workflows. Start one from an active commercial policy."}</p> : (
              <div style={{ display: "grid", gap: 12 }}>
                {clientWorkflows.map(function(wf) {
                  var pol = data.policies.find(function(p) { return p.id === wf.policyId; });
                  var completedCount = wf.steps.filter(function(s) { return s.completed; }).length;
                  return (
                    <div key={wf.id} style={{ background: "#0f1724", borderRadius: 10, padding: 14, border: "1px solid #1e293b" }}>
                      <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 10 }}>
                        <div><div style={{ fontSize: 14, fontWeight: 600, color: "#f8fafc" }}>{pol ? (pol.coverageType + " - " + pol.carrier) : "Policy"}</div><div style={{ fontSize: 11, color: "#64748b" }}>{"Exp: " + formatDateShort(wf.expirationDate) + " \u2022 " + String(completedCount) + "/" + String(wf.steps.length) + " steps done"}</div></div>
                        <div style={{ width: 60, height: 6, background: "#1e293b", borderRadius: 3 }}><div style={{ width: String(Math.round(completedCount / wf.steps.length * 100)) + "%", height: "100%", background: completedCount === wf.steps.length ? "#10b981" : "#f59e0b", borderRadius: 3, transition: "width 0.3s" }} /></div>
                      </div>
                      <div style={{ display: "grid", gap: 4 }}>
                        {wf.steps.map(function(step, idx) {
                          var daysDiff = daysUntil(step.targetDate);
                          var isOverdue = !step.completed && daysDiff < 0;
                          return (
                            <div key={idx} style={{ display: "flex", alignItems: "flex-start", gap: 8, padding: "6px 8px", borderRadius: 6, opacity: step.completed ? 0.5 : 1, background: isOverdue ? "rgba(239,68,68,0.06)" : "transparent" }}>
                              <button onClick={function() { toggleWorkflowStep(wf.id, idx); }} style={{ background: "none", border: "none", cursor: "pointer", color: step.completed ? "#10b981" : isOverdue ? "#ef4444" : "#475569", padding: 0, marginTop: 1 }}><CheckCircle size={14} /></button>
                              <div style={{ flex: 1 }}>
                                <div style={{ fontSize: 13, color: step.completed ? "#94a3b8" : "#e2e8f0", textDecoration: step.completed ? "line-through" : "none", fontWeight: 500 }}>{step.label}</div>
                                <div style={{ fontSize: 11, color: "#64748b" }}>{step.desc}</div>
                              </div>
                              <div style={{ fontSize: 11, color: isOverdue ? "#f87171" : "#64748b", whiteSpace: "nowrap" }}>{formatDateShort(step.targetDate)} {isOverdue && " \u26a0\ufe0f"}</div>
                            </div>
                          );
                        })}
                      </div>
                    </div>
                  );
                })}
              </div>
            )}
          </div>
        )}
      </div>
    );
  };

  // PIPELINE
  const PipelineView = function() {
    return (
      <div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
          <div><h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{"Sales Pipeline"}</h2><p style={{ margin: "2px 0 0", fontSize: 12, color: "#64748b" }}>{"Track prospects from lead to close"}</p></div>
          <div style={{ display: "flex", gap: 8 }}><button style={st.btn("outline")} onClick={function() { exportCSV("prospects"); }}><Download size={14} /></button><button style={{ ...st.btn("primary"), background: "#15803d" }} onClick={function() { setModal("add-prospect"); }}><UserPlus size={14} /> {"New Prospect"}</button></div>
        </div>

        <div style={{ ...st.card, padding: 14 }}>
          <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
            {PIPELINE_STAGES.map(function(s2) {
              var sc = STAGE_COLORS[s2] || {};
              var active = pipelineFilter === s2;
              return (
                <button key={s2} onClick={function() { setPipelineFilter(pipelineFilter === s2 ? "all" : s2); }} style={{ flex: 1, minWidth: 100, background: active ? sc.bg : "#0f1724", borderRadius: 8, padding: "10px 8px", textAlign: "center", border: active ? "1px solid " + (sc.fg || "#fff") + "40" : "1px solid transparent", cursor: "pointer", transition: "all 0.15s" }}>
                  <div style={{ fontSize: 18, fontWeight: 700, color: sc.fg || "#94a3b8" }}>{String(pipelineStats[s2] ? pipelineStats[s2].count : 0)}</div>
                  <div style={{ fontSize: 10, color: "#64748b" }}>{s2}</div>
                </button>
              );
            })}
          </div>
        </div>

        <div style={{ display: "flex", gap: 10, marginBottom: 14 }}>
          <div style={{ flex: 1, position: "relative" }}><Search size={15} style={{ position: "absolute", left: 11, top: 11, color: "#475569" }} /><input style={{ ...st.input, paddingLeft: 34 }} placeholder="Search prospects..." value={searchTerm} onChange={function(e) { setSearchTerm(e.target.value); }} /></div>
          <select style={{ ...st.select, width: 160 }} value={pipelineLineFilter} onChange={function(e) { setPipelineLineFilter(e.target.value); }}><option value="all">{"All Lines"}</option><option value="Personal">{"Personal"}</option><option value="Commercial">{"Commercial"}</option></select>
        </div>

        {filteredProspects.length === 0 ? (
          <div style={{ textAlign: "center", padding: 40, color: "#475569" }}><Target size={36} style={{ marginBottom: 10, opacity: 0.3 }} /><p style={{ fontSize: 14, fontWeight: 500 }}>{"No prospects" + (pipelineFilter !== "all" ? ' in "' + pipelineFilter + '"' : "")}</p></div>
        ) : (
          <div style={{ display: "grid", gap: 6 }}>
            {filteredProspects.map(function(p) {
              return (
                <div key={p.id} style={{ ...st.card, marginBottom: 0, cursor: "pointer", padding: "14px 18px", display: "flex", alignItems: "center", justifyContent: "space-between" }}
                  onClick={function() { setSelectedProspectId(p.id); setView("prospect-detail"); }}>
                  <div style={{ display: "flex", alignItems: "center", gap: 12 }}>
                    <div style={{ width: 38, height: 38, borderRadius: 10, background: p.lineType === "Personal" ? "#1e293b" : "rgba(30,58,95,0.12)", display: "flex", alignItems: "center", justifyContent: "center" }}>
                      {p.lineType === "Personal" ? <User size={17} color="#94a3b8" /> : <Building2 size={17} color="#7dd3fc" />}
                    </div>
                    <div>
                      <div style={{ fontSize: 14, fontWeight: 600, color: "#f8fafc" }}>{String(p.name)}</div>
                      <div style={{ fontSize: 12, color: "#64748b", display: "flex", gap: 8, alignItems: "center", marginTop: 2 }}>
                        <LineTypeBadge type={p.lineType} />
                        {p.source && <span>{String(p.source)}</span>}
                        {p.products && p.products.length > 0 && <span>{"\xb7 " + p.products.join(", ")}</span>}
                      </div>
                    </div>
                  </div>
                  <div style={{ display: "flex", alignItems: "center", gap: 14 }}>
                    {p.estimatedPremium && <span style={{ fontSize: 14, fontWeight: 600, color: "#10b981" }}>{"$" + parseFloat(p.estimatedPremium).toLocaleString()}</span>}
                    <StageBadge stage={p.stage} />
                    <ChevronRight size={15} color="#475569" />
                  </div>
                </div>
              );
            })}
          </div>
        )}
      </div>
    );
  };

  const ProspectDetail = function() {
    if (!selectedProspect) return null;
    var sp = selectedProspect;
    return (
      <div>
        <button onClick={function() { setView("pipeline"); setSelectedProspectId(null); }} style={{ ...st.btn("outline"), marginBottom: 12, padding: "5px 12px" }}><ArrowLeft size={14} /> {"Back"}</button>
        <div style={{ ...st.card, display: "flex", justifyContent: "space-between", alignItems: "flex-start" }}>
          <div>
            <div style={{ display: "flex", alignItems: "center", gap: 10 }}>
              <h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{String(sp.name)}</h2>
              <LineTypeBadge type={sp.lineType} />
              <StageBadge stage={sp.stage} />
            </div>
            <div style={{ display: "flex", gap: 14, marginTop: 8, flexWrap: "wrap", fontSize: 13, color: "#94a3b8" }}>
              {sp.contactName && <span><User size={13} style={{ verticalAlign: "middle" }} /> {String(sp.contactName)}</span>}
              {sp.phone && <span><Phone size={13} style={{ verticalAlign: "middle" }} /> {String(sp.phone)}</span>}
              {sp.email && <span><Mail size={13} style={{ verticalAlign: "middle" }} /> {String(sp.email)}</span>}
              {sp.address && <span><MapPin size={13} style={{ verticalAlign: "middle" }} /> {String(sp.address)}</span>}
              {sp.source && <span><Zap size={13} style={{ verticalAlign: "middle" }} /> {String(sp.source)}</span>}
            </div>
            {sp.products && sp.products.length > 0 && <div style={{ marginTop: 8, display: "flex", gap: 6, flexWrap: "wrap" }}>{sp.products.map(function(p) { return <span key={p} style={{ background: "rgba(29,78,216,0.08)", color: "#93c5fd", padding: "3px 10px", borderRadius: 6, fontSize: 12 }}>{String(p)}</span>; })}</div>}
            {sp.notes && <p style={{ marginTop: 8, fontSize: 13, color: "#64748b" }}>{String(sp.notes)}</p>}
            {sp.estimatedPremium && <div style={{ marginTop: 8, fontSize: 14, fontWeight: 600, color: "#10b981" }}>{"Est. Premium: $" + parseFloat(sp.estimatedPremium).toLocaleString() + "/yr"}</div>}
          </div>
          <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
            {sp.stage !== "Won" && sp.stage !== "Lost" && <button style={st.btn("success")} onClick={function() { convertProspect(sp); }}><CheckCircle size={14} /> {"Convert to Client"}</button>}
            {sp.email && (
              <div style={{ position: "relative" }}>
                <button style={st.btn("primary")} onClick={function() { setEmailMenuFor(emailMenuFor === "prospect" ? null : "prospect"); }}><Mail size={14} /> {"Email"}</button>
                {emailMenuFor === "prospect" && <EmailMenu entity={sp} entityType="prospect" position={{ right: 0, marginTop: 4 }} />}
              </div>
            )}
            <button style={st.btn("outline")} onClick={function() { setEditItem(sp); setModal("edit-prospect"); }}><Edit2 size={14} /></button>
            <button style={{ ...st.btn("outline"), borderColor: "#7f1d1d" }} onClick={function() { deleteProspect(sp.id); setView("pipeline"); }}><Trash2 size={14} color="#f87171" /></button>
          </div>
        </div>

        {sp.stage !== "Won" && sp.stage !== "Lost" && (
          <div style={{ ...st.card, padding: 14 }}>
            <div style={{ ...st.cardTitle, marginBottom: 10 }}>{"Move Stage"}</div>
            <div style={{ display: "flex", gap: 6, flexWrap: "wrap" }}>
              {PIPELINE_STAGES.map(function(s2) {
                var sc = STAGE_COLORS[s2] || {};
                return <button key={s2} onClick={function() { updateProspect({ ...sp, stage: s2 }); }} style={{ padding: "6px 14px", borderRadius: 8, border: sp.stage === s2 ? "2px solid " + (sc.fg || "#fff") : "1px solid #334155", background: sp.stage === s2 ? sc.bg : "transparent", color: sp.stage === s2 ? sc.fg : "#94a3b8", cursor: "pointer", fontSize: 12, fontWeight: 600 }}>{s2}</button>;
              })}
            </div>
          </div>
        )}

        <div style={st.card}>
          <div style={st.cardHeader}><div style={st.cardTitle}><Clock size={16} color="#8b5cf6" /> {"Activity (" + String(prospectActivities.length) + ")"}</div><button style={st.btn("primary")} onClick={function() { setModal("add-activity-prospect"); }}><Plus size={14} /> {"Log"}</button></div>
          {prospectActivities.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 14 }}>{"No activity yet \u2014 log your first touchpoint"}</p> : (
            <div style={{ display: "grid", gap: 5 }}>
              {prospectActivities.slice(0, 20).map(function(a) {
                return (
                  <div key={a.id} style={{ display: "flex", alignItems: "flex-start", gap: 8, padding: "8px 10px", background: "#0f1724", borderRadius: 8 }}>
                    <div style={{ color: "#64748b", marginTop: 2 }}>{getActivityIcon(a.type)}</div>
                    <div style={{ flex: 1 }}><div style={{ fontSize: 13, color: "#e2e8f0" }}>{String(a.notes)}</div><div style={{ fontSize: 11, color: "#64748b", marginTop: 1 }}>{String(a.type) + " \xb7 " + formatDateShort(a.date)}</div></div>
                  </div>
                );
              })}
            </div>
          )}
        </div>
      </div>
    );
  };

  // CALENDAR
  const CalendarView = function() {
    var y = calendarMonth.getFullYear();
    var m = calendarMonth.getMonth();
    var firstDay = new Date(y, m, 1).getDay();
    var daysInMonth = new Date(y, m + 1, 0).getDate();
    var today = new Date(); today.setHours(0,0,0,0);
    var cells = [];
    for (var i = 0; i < firstDay; i++) cells.push(null);
    for (var d = 1; d <= daysInMonth; d++) cells.push(d);

    var getEventsForDay = function(day) {
      var ds = String(y) + "-" + String(m + 1).padStart(2, "0") + "-" + String(day).padStart(2, "0");
      var renewals = calendarRenewals.filter(function(p) { return p.expirationDate === ds; });
      var followups = calendarFollowUps.filter(function(f) { return f.dueDate === ds; });
      return { renewals: renewals, followups: followups };
    };

    return (
      <div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
          <h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{"Renewal Calendar"}</h2>
          <div style={{ display: "flex", gap: 8 }}><button style={st.btn("outline")} onClick={function() { exportCSV("renewals"); }}><Download size={14} /> {"Export Renewals"}</button></div>
        </div>
        <div style={st.card}>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 16 }}>
            <button style={st.btn("outline")} onClick={function() { setCalendarMonth(new Date(y, m - 1, 1)); }}><ChevronLeft size={16} /></button>
            <h3 style={{ margin: 0, fontSize: 16, fontWeight: 700, color: "#f8fafc" }}>{calendarMonth.toLocaleDateString("en-US", { month: "long", year: "numeric" })}</h3>
            <button style={st.btn("outline")} onClick={function() { setCalendarMonth(new Date(y, m + 1, 1)); }}><ChevronRight size={16} /></button>
          </div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(7, 1fr)", gap: 2 }}>
            {["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"].map(function(dayName) { return <div key={dayName} style={{ textAlign: "center", padding: 6, fontSize: 11, fontWeight: 600, color: "#64748b" }}>{dayName}</div>; })}
            {cells.map(function(day, idx) {
              if (!day) return <div key={"e" + String(idx)} style={{ minHeight: 80 }} />;
              var evts = getEventsForDay(day);
              var isToday = today.getFullYear() === y && today.getMonth() === m && today.getDate() === day;
              return (
                <div key={String(day)} style={{ minHeight: 80, background: isToday ? "rgba(29,78,216,0.06)" : "#0f1724", borderRadius: 6, padding: 6, border: isToday ? "1px solid rgba(29,78,216,0.25)" : "1px solid transparent" }}>
                  <div style={{ fontSize: 12, fontWeight: isToday ? 700 : 500, color: isToday ? "#93c5fd" : "#94a3b8", marginBottom: 4 }}>{String(day)}</div>
                  {evts.renewals.map(function(r) { var c = data.clients.find(function(cl) { return cl.id === r.clientId; }); return (
                    <div key={r.id} onClick={function() { setSelectedClientId(r.clientId); setView("client-detail"); }} style={{ fontSize: 10, padding: "2px 4px", borderRadius: 3, background: "#78350f", color: "#fcd34d", marginBottom: 2, cursor: "pointer", overflow: "hidden", whiteSpace: "nowrap", textOverflow: "ellipsis" }}>{"\u27f3 " + (c ? getFullName(c).substring(0, 14) : "")}</div>
                  ); })}
                  {evts.followups.map(function(f) { return (
                    <div key={f.id} style={{ fontSize: 10, padding: "2px 4px", borderRadius: 3, background: "#4c1d95", color: "#c4b5fd", marginBottom: 2, overflow: "hidden", whiteSpace: "nowrap", textOverflow: "ellipsis" }}>{"\u2713 " + String(f.description || "").substring(0, 14)}</div>
                  ); })}
                </div>
              );
            })}
          </div>
          <div style={{ display: "flex", gap: 16, marginTop: 12, fontSize: 11, color: "#64748b" }}>
            <span><span style={{ display: "inline-block", width: 10, height: 10, borderRadius: 2, background: "#78350f", marginRight: 4 }} />{"Renewal"}</span>
            <span><span style={{ display: "inline-block", width: 10, height: 10, borderRadius: 2, background: "#4c1d95", marginRight: 4 }} />{"Follow-Up"}</span>
          </div>
        </div>

        <div style={st.card}>
          <div style={st.cardTitle}>{"Renewals This Month (" + String(calendarRenewals.length) + ")"}</div>
          {calendarRenewals.length === 0 ? <p style={{ color: "#475569", fontSize: 13, textAlign: "center", padding: 12 }}>{"No renewals this month"}</p> : (
            <div style={{ display: "grid", gap: 6, marginTop: 10 }}>
              {calendarRenewals.slice().sort(function(a, b) { return new Date(a.expirationDate) - new Date(b.expirationDate); }).map(function(p) {
                var c = data.clients.find(function(cl) { return cl.id === p.clientId; });
                return (
                  <div key={p.id} style={st.row} onClick={function() { setSelectedClientId(p.clientId); setView("client-detail"); }}>
                    <div style={{ flex: 1 }}><div style={{ fontSize: 13, fontWeight: 600, color: "#e2e8f0" }}>{c ? getFullName(c) : "Unknown"}</div><div style={{ fontSize: 11, color: "#64748b" }}>{String(p.coverageType) + " \xb7 " + String(p.carrier) + " \xb7 $" + parseFloat(p.premium || 0).toLocaleString()}</div></div>
                    <span style={{ fontSize: 12, color: "#94a3b8", marginRight: 6 }}>{formatDateShort(p.expirationDate)}</span>
                    <RenewalBadge days={daysUntil(p.expirationDate)} />
                  </div>
                );
              })}
            </div>
          )}
        </div>
      </div>
    );
  };

  // REPORTS
  const ReportsView = function() {
    var reportData = reportView === "carrier" ? premiumByCarrier : reportView === "coverage" ? premiumByCoverage : premiumByClient;
    var reportTitle = reportView === "carrier" ? "Premium by Carrier" : reportView === "coverage" ? "Premium by Coverage" : "Premium by Client";

    var snapshotItems = [
      { label: "Total Clients", value: String(data.clients.length), color: "#3b82f6" },
      { label: "Active Policies", value: String(activePolicies.length), color: "#10b981" },
      { label: "Avg Premium / Policy", value: activePolicies.length ? "$" + Math.round(totalPremium / activePolicies.length).toLocaleString() : "$0", color: "#f59e0b" },
      { label: "Avg Premium / Client", value: data.clients.length ? "$" + Math.round(totalPremium / data.clients.length).toLocaleString() : "$0", color: "#8b5cf6" },
      { label: "Renewals (90 days)", value: String(upcomingRenewals.length), color: "#ef4444" },
      { label: "Active Prospects", value: String(activeProspects.length), color: "#06b6d4" },
      { label: "Pipeline Value", value: "$" + activeProspects.reduce(function(sum, p) { return sum + (parseFloat(p.estimatedPremium) || 0); }, 0).toLocaleString(), color: "#15803d" },
      { label: "Won This Period", value: String(data.prospects.filter(function(p) { return p.stage === "Won"; }).length), color: "#10b981" },
    ];

    var reportTabs = [
      { key: "carrier", label: "By Carrier" },
      { key: "coverage", label: "By Coverage" },
      { key: "client", label: "By Client" },
    ];

    return (
      <div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
          <h2 style={{ margin: 0, fontSize: 20, fontWeight: 700, color: "#f8fafc" }}>{"Premium Reports"}</h2>
          <button style={st.btn("outline")} onClick={function() { setModal("import"); }}><Upload size={14} /> {"Import"}</button>
          <button style={st.btn("outline")} onClick={function() { setModal("export"); }}><Download size={14} /> {"Export All"}</button>
        </div>
        <div style={{ display: "flex", gap: 6, marginBottom: 14 }}>
          {reportTabs.map(function(tab) {
            return <button key={tab.key} style={st.navBtn(reportView === tab.key)} onClick={function() { setReportView(tab.key); }}>{tab.label}</button>;
          })}
        </div>
        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 14 }}>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><PieChart size={16} color="#3b82f6" /> {reportTitle}</div></div>
            <div style={{ marginBottom: 14, textAlign: "center" }}>
              <div style={{ fontSize: 30, fontWeight: 800, color: "#f8fafc" }}>{"$" + totalPremium.toLocaleString()}</div>
              <div style={{ fontSize: 12, color: "#64748b" }}>{"Total Active Premium"}</div>
            </div>
            <BarViz items={reportData} total={totalPremium} />
          </div>
          <div style={st.card}>
            <div style={st.cardHeader}><div style={st.cardTitle}><BarChart3 size={16} color="#10b981" /> {"Book Snapshot"}</div></div>
            <div style={{ display: "grid", gap: 14 }}>
              {snapshotItems.map(function(item) {
                return (
                  <div key={item.label} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", padding: "8px 0", borderBottom: "1px solid rgba(30,41,59,0.08)" }}>
                    <span style={{ fontSize: 13, color: "#94a3b8" }}>{item.label}</span>
                    <span style={{ fontSize: 15, fontWeight: 700, color: item.color }}>{item.value}</span>
                  </div>
                );
              })}
            </div>
          </div>
        </div>

        <div style={st.card}>
          <div style={st.cardHeader}><div style={st.cardTitle}><TrendingUp size={16} color="#f59e0b" /> {"Pipeline Conversion"}</div></div>
          <div style={{ display: "grid", gridTemplateColumns: "repeat(7, 1fr)", gap: 4 }}>
            {PIPELINE_STAGES.map(function(s2) {
              var ct = pipelineStats[s2] ? pipelineStats[s2].count : 0;
              var total = data.prospects.length || 1;
              var sc = STAGE_COLORS[s2] || {};
              return (
                <div key={s2} style={{ textAlign: "center" }}>
                  <div style={{ height: 100, display: "flex", alignItems: "flex-end", justifyContent: "center", marginBottom: 6 }}>
                    <div style={{ width: "60%", background: sc.bg || "#1e293b", borderRadius: "4px 4px 0 0", height: String(Math.max(8, (ct / total) * 100)) + "%", border: "1px solid " + (sc.fg || "#94a3b8") + "30", transition: "height 0.4s" }} />
                  </div>
                  <div style={{ fontSize: 18, fontWeight: 700, color: sc.fg || "#94a3b8" }}>{String(ct)}</div>
                  <div style={{ fontSize: 10, color: "#64748b", lineHeight: 1.2 }}>{s2}</div>
                </div>
              );
            })}
          </div>
        </div>
      </div>
    );
  };

  // MAIN RENDER
  return (
    <div style={st.app}>
      <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet" />

      {toast && <div style={{ position: "fixed", bottom: 24, left: "50%", transform: "translateX(-50%)", background: "#15803d", color: "#fff", padding: "10px 24px", borderRadius: 10, fontSize: 13, fontWeight: 600, zIndex: 200, boxShadow: "0 8px 24px rgba(0,0,0,0.5)" }}>{toast}</div>}

      <header style={st.header}>
        <div style={{ display: "flex", alignItems: "center", gap: 10 }}><img src={"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAZQAAABICAYAAADRTgNAAAAsP0lEQVR4nO2dd5xnVXn/38/MbKEu4ILSLCBFsAKCSkdFLCAiRWJsRE3RYKJg1IiaWFH4mUQsCIkEiSIS6SBdFFEQrIQqvbPA0nbZ3Smf3x/PefacufudmW/f2d37eb3u6ztz77mn3/PU8xyjTUgywIABwMxseIr0zwHWT+88B3hF+n8AGAPmAusCawNrArOBOYBSFqPAE8AIML+4nkn3FgC3ADcBS1L6W8xsdJI6zUj5jwEyM02UtkaNGjVqTA5rNmEiIAPxnpmNNEgzA3g+TiyGgDcAmwKDwBZkAjJQfbfLGMEJyo040VkE/BR4ELgX+E0jAihpiEzAxmoCU6NGjRrNY0KCUpFAxsxsrPJ8HVyiCKKxJ/C8dG+1KcodI0sGY5VnzRK5crFfKikVv5PhfmAecCHwCHAW8KiZPTquACmI32hNXGrUqFFjciyz8MYiWpVAJM0CdgZeBuyOSyGbNsoDGMYJhZEXfgNmdq3mUyOklCg7fmdMkP5B4GrgN8BVwFVmtjgeJgI7SAPiWqNGjRo10kKbiIhV7Q2SXgTsA+wFbANs1iCPcuEeTHkOTlLmo+n5CHAr8CdcPTaW7g+nZ4savDuAE4SZ6Xcwvbcu8EpgVkozi4mlpFHGS0dD6ariduD3wMXAuWZ2bzyoiUuNGjVqLItGEsorgQNwFdZ2jOfox8gLMulZIwnlKeCG9Owc4B58of8/3Gg+G1hgZgu60gqv92o4IRnCDfuvSX+vDrwNWAt4LrBho9dxQgaZIJZ2nmeAXwOXA+eZ2W8rZVutEqtRo8aqDpM0CGyLL7r7Ay+vpBnGF9ywT1Slj4W4mugO4CKcs59nZrdPVXgygpf5qfK7TH0nuDcGjEy1qEvaAHgBTlTeCjwLeC1OdEqMku08AywrwVwH/Ag438z+b7Iya9SoUWNVgUn6HvCX5EVTuMpJ+GJfJSC34VLGZTghucnM5lUzljSTgkA08grrNZLXWdhxzMyWNEizPrAlsBPwemArnOiUGCHbhIbIhG0Jbnc5FDf0U0sqNWrUWFVhki7CF9JFZBtIyZEvAq7ACch1wM+rLrdJ0hhotGAXadbH1U7r4gv4XFz1NQKsB7w4Pbd0fwbjPcAG8AU89pg8hhO2p8g2l/uBP+MqqqfM7JFJ6jMLJ3RLGtzfFXdA2Bl3QCidCYLYqri/nZn9TtJAt20qhbfdUsI41StF2hV2b00nasTqu8tLJdnNNvQD0011uyKO26qOIeABfJGcXdx/GLgUN0hfZmZ3xQNJg4mAEFJH/EqagxOMl+GbF18FrANsgu9PmYVvWmx6/0sbWIwTnUWSbsW9t+bhNpBHcSeAeVX7TbHJccTMLgEuSfefD7wR2BvYDSd+gSBkz3Sj4sVen1DjBUFoe3JX8uyK+3M/PrhO8q++G//3guC3Uo9+vbu8yuz2vFgRx63XmO7EziSdBhwEPIS7y54KXGRmj0eipL4aLb3A0kK1PU4odsFVRS/F7RKzpig3JJxysbTi3pT1rqQtufhGHlslFuOSzPW4+u5nwJ+rtpDk+TZUSjBpt//ewMG49LJOerSZmd3RycSf6N1U5oY4UQipaM30OxeXKhfj+2kW4DatAZzQ3dpAAgvvtGk7KaGzRaT6bvkR9nNxavfjT99W3xc2SYOTRZboN8r69GvcllffrywwSfsCzwbOMbOH4kEiIiMxiKmjn0fm1LcDXjRBvmNk1RBkDjlUar3GWHGVdah6bwWWADcDfwSuxL257qgQkxmlqk/SJrgTwy7Ah8zs0Q4WkIGin3cHdsDdtdfBCfbcVvPE+/9OPFzNr9N1QWzebOcDjXckfQ14UyojbGzdHNcxXOV5ipl9oZm6ShoysxFJfwUcgRPZYC6ibieY2b9F2m5VNsY9OX38FJf2l+CM1UlmdnSTbYj+/TawB67a7df3MojPlzdPNoeLOr4Q+Emq3yje18eY2Umt9G8hQf8QV3uXbR7EGaX3mNnt3SZ4RVv2B76Yyp6BM7xvM7PbJhu3yrhfgG9VCCa5F+M2DBxkZrdONZ+Ktu0IfA//VoPhfq+ZXdMLIj1kZucUlZiJc68jZrZE0ixJr8AlmN1wb7Byf4do7BE1wMSbGJ9IaR8B7sPVaxHP6xlcLfUkzm0vIEsea+Mf6ppk+0sQqk1wLn5O+n8tJg7vEk4HYWSPur4kXe/EF4M7JF0KnAFcb2YPFv00I+1LOS5dQHtcTTHwOwNH45JPFeWgq7iqKMPjDAEvTH9vD3wImC/p+8BnzezxNiZUfCQ74vuSeo2XVcqdDJFmE2DrCdJ8XdKImR3XZaISNqvV8Q2/JbYp0jSTD/h3NlEbeompNAslVse/lxKttLVckIdw9fimEyS9UNLeSQvQTaIS685mLDuf18c1GJO1JcZ9DZzB7gc2xvfvTdXH8Xxdlm3b3EqarmGoVO0ERy7pNcBbcNfaamWC0sXi1UjFtAS3VTyFe4LdDjyN7015FB+EBycz4reKwn4DTly2xYnP1jjnswaukovNkdU2hUop1EpbpevvgHmSfgWcBlxSkeTGSS4t1jmIyatxm9UsMpEu69Ju7LMgnODc3rrA4cDrJb0RuLtNLuVpsnPEZJtY20Xk+1Qb7y7B2zxMHudgHgC+IekJM/t+tyWVotzYuDtEe21YQOv9W42RF/OoGYyldxeSFskmpO2RVMchcl+HXbJVxkp4P4VWIb7FePZC4FxJuyVNQLc564jsEWMGy4aEmgyjuIq51zEKDa9jK4g1oNx83jOP26E0MEuSF9YhwHtwlUsgKhNicZWAPIBLGxfhBvBf4B5YtzUj4lduWeW34WuVX3Dj9RO49AMuuv+qUtYQ7l22FvA6nAN5LU6tn9OgjCASQyntful6TNLluLh/iZk9PEldJ26Ei/qSb8j8Dk5M4sMsF4eH8A99kPGhZKL9oVoJMXsopZuNqzIDIUUO46rKE/A4bO1gLfoTRqe6P6gZBKNT9mFwouHscLKkhWb2v50wBBNgoMHVKubQnf5tldivS5pXTUjb1X7uNOhrdbwCoVHYBjhT0j5mtqDLRKXRnGkFA4x3auolWq1ftK1qfugJhgAkfRL4R3zhDMRH1oijDy7iT8AeZvZYo8yVQ5RMRAS6xmUU7rVQ6TAzG02c6A3p1tXFO3OAvwD+DW9nLMzlBx2bOwdwL6+3p2uepGOAr3kxLbVnwMxGJb0Kl5wiDEyUcyHwbeDnwOPpWXAWSwlKUhnEhIl6D6d27QhsAPwVrrIMiWcUdxXf2cyubEGNEO37KC5690pXHPn+uVJuO1iAz9NXMZ6onCrpbWZ2bg+ISruIdn4MH7dm+jcYjffiNr3gsh8BPkzjEEZVRDlPTwNjdJT/EK5VWJPcxl2AcyS90cwW99v7qwHKuu5HXri7/U1EnqP41g3o7JvoLSRdK8diSaOSxjQeD0k6TtJZ6f+R9LsoGaeRNFPSkKSBdPXDmNgUJFm6om5DUdf0fHNJS1KbxiQNSzpJ0s1aFmOp/YvS/99LeUzlXVat02D6/XxRZvTrt3vQB98pxm44/X1cO3WfjpC7fSPpU6ltMZ4LJW0s6YL0/3Axx4clval8v82yYx49txjD6ONvpWe9UA2WdTgqlbc4/d7Ro3KirdsWbYy+/pf0rKn5pLRGyNeOGyt5nS5pL0nPpLEaK8o7X9LqZX3abEsw1IdXxkxyY3bPx61XKNaX1xXffczNN5RpuokY+Btwo1J4YRlOdS/AQ7tfYmZPS5qLx+WajVPNWWRRb2Q5cwsTouC64jc8qoYkCTekhndH6IIPx1VNO+Hc/dvwAJRlCBoB13ZYvXXJEscg7qTwmfSxDZFCymi86+s4/baycbNKxEOEHwE+ju/oX4usOotgny17e9F7fTF0J/jmTNzj60DcTrUT2WY2CJwhaX8zu0Ddt6m0hfShN8uQxbytqgcHJa1NYRdppuhp5Da8ppldJulg4Mx0L+byG3H11/5mtlDLX1JpdczaLoZp7vIfi8JVZJEKXEXwEjN7n5mdmYhJRASONPG7dyWvFQppcMKYHwN1D7Aoebv90sy+bGY74oSl9DwzstG13UHeqqwOrqqY71Wz4Zg85SSqTqgyTeUaTaqcATN7EjiPbHwcAbaRtFZyDGj6YzCz8ATs9dWNRWIUWM18I+ubcZVBzGXwBflcSQeaux0vd2ktVLTNXDjDUbroB4TvHVuapolruhATgOFEKM7BVbahToqI5K/H1V9rpvm7XNefVsasg2van8sUgzA//cai8lxgNfmu+BlpsRnF3XlDhxec3PMq765IiMHZo3L/HnO36cF0zUx9cD/ZthKG3j9V8mq3DoEBYLDVRX4KDKa8bsY/yNn4oroJrbmKrqgYTVLco/j+nt+RnRdCP/1jSe+eLkSlBVQ3Bpf3p/XiMwXCA3KmmZ2EE5VQ0YQ9cS+cqKw7HYhKjUxQrsFdQSN+1hxgq8SxhIg1mLidMJTGBN41/Y50cQHsF8bke29ig2Z8gNekX6v0wR5kFUNIE3dX3m0Vt1X+X49EzOkekQ7O5iZchXkarkY4DmcSVnpY2u9gHt/ttfhGz1JSGQP+W9K7VkCisjJjOI3bfwF/w3j18Aj+TZ4laY2aqCx/REyuOyQ9gntUjOKE5s14LK/qonYlcBiZW9hW0gZm9vCKRFCU94Bsgm+gE9mm9Idq8vQb7tSxCN2Mbxa0DkTRxxjvxbEBcLiZ/avckaAkLOXO/ylRqMJG0++P8LD7E6ZtBn3SFwM5TlyXMCb3aJsvN8afB7yavDs7XIqHzezU6WJTWdURBN7Mjpc0DPwn44nKrriksi/Qd5uKsjdrPzCt1V5DiRMbxaMJH0Ze3HZI1H40dVg04mpyyI0R8mFWZ9LjTTNdRiyIO5DOjcfrH4dpke5h7t47gEceLt/9TSJKpUtvqwj71dIAjsDnJD0JfNM6cGctJno5fqGqgzaNsNNM194SYiwTUdkHn7d7kg31Y8D3Jc03swtrojI9kIjKDDP7L/ej4bvkcE4j+Biehm/GHusnUUkLfD1HyBKKJP2G8ZLHTsBzzezONDhBWG4FbsE3GsWA7Yl/mNOWcjbAgKQxXP0BmUjeADyk7NIYezS2ATYnb/AE3yPSLsJGcinep1swfmf014G/k4d/+SPuqXQ5LtE047UzbGYLaTDRk4TR8j6gwptsb7wver0PZT7w424TsFCNmNmTkt6Cnyq6F1lSGcRtKm80s19qmgVNXFVhZkvVX5IWA6eQv8cRPL7cafgeMetQczAliu9hTTxkUy/VbfFNnGNm9/a6be2i1CFfQA7yNpx+95F0PJlzG0iD+kvGh2TZJ9kihqdrQ0ukOg5Lmo0baSEv0peH1JG4olgw98AN8rFx7DHgl+lZO1y+0kK1SNIRuG0jPFjCJXmLdAUW4YSlGTwt6Xo87A3pvTOAB8zsVshqvxaqHZLcZ3GptNd4FF/sF3R7XhVEZaGktwPnk9Vf4O7VZ0ra2cxumQ6uqTXGSSr/I48ycQKZERvB3ft/aGbvSCrjXq5HsWasj0e76AeewgnptNQGDRWGrPtx75cdyNTwDWb2ncTJlzgDeD954dsSeIWZXa28a3s6I6STHXFPp9ilbvjCDsvu7n9z+g2ie52ZPdLJQlOoX86W9C7gm7gKkVSnJWRvnQjv0GyIhzn4bvYS/wAslnQh8DEz+3Ob9Z+PE7dexfKKSAwPTZWwExRE5XF5bLPL8P1Y8aHOBc6T9MqUppZUpgEKSeVESWsB/4+sYRgGDkmM4KG4pDLV3o1Gz1qRvEfJx0b0CsHINstQLhcsjZ2TdPUXpP+jM3eTNLdwYY2F50p8USmp5P6VPKc10gQ7hLxZagCPAfbHaGvibkYlbUS2n0T7zlMOvd1JPWJROwVfzI5N9YgoyLF5NI5UbuaKvSaLcZvQInIAvFl4mIhfSNqmTc+YdVKd1iATuW5eq6ffufTY+J/aP2geC+4AfA9ShMAZxQMTniNpTpoLkxHQ6PsaPUZhqP868AmyG/gQzogdDHwnMQDhNj8ROmWAB8lztlfXmuRvY9qiGlnzdOCfyH7e6+Ei5Akkt+H08T2VdPsHkgfjAEmfYRqKYSUKYrEOTgRLO8AVSa8e6q7oh4PwsP0juNvwCK7LVAPprWUUi9ptwBGS/gknYJvhfWz4OfdbTJLNuCxpHAk66roED4j5Q0k7kFy+m1ANxPNL8A2evZZQ7iXHlOsZglCY2V2SXo+3bxO8fRFD6lxJb0pzfyJJZZAcD65Gj1EQlaPloXM+z/hv9AOSnjSzI+T7yaqSSrmHp/odNxVZIP0uwJnx0Nj0ggmKb+LW4v9phzDKBzf+R0m/x1VBsfv2L3CCEg2IzoqTHsMOsyW+CF46zVUDQRhfCWxEdpMGDxhYGryjDYel33DbvQoIZ4W2B1Y5hIlw0bw8WvmydJ2Y0q6OnxfRzGRdGz+r4oW4ZLMOLpXMTWXNTG15KbC7mV2SOO9Jxyzaamafa6GZXUGv7XKJqAyZ2c3J/fRivL9C2tsFuEQe7uOByhxXGsvH8b0+W5O55Zq49BajyabyhWTHPYpsAx4BPpaIyr9OMsfvJNsHA1OOm2W3/Idxh4C+Ybra80oOdlDSKH4E8I7kRXZ3SS82s+tjQNKi+1Pc7rIRPoADwLvS4tS/FrSOUN99hKyimIF7rl0SUkcsGPKzSrYlcwgGnGzZXbjtgU2TouH7yns9YtIuxPe9NItryn8krQf8B+6NEuUaHsr/ElrgqtLi2a99KH1jTAoJ/Pdyl+ILyBG4R/Dv4iJJbzazu2OOWI61FraYK/BoE7FXokaPkBb1sKlEDLxPM35rw79IWmJmX1HhBl7YMM+RdDSunSlPIW0aU6hCu4kVIpYX5A0zZ5CPTw03yvekNKEWGTCzp1PaEvtK2tCyi/G0QuEwsBn5LJCo5w8KEbocsL8mh88exL27ot1tLXbKLsnbSTpE0n6SDkpSU3ihRWyg0ehP5WjJzVxDxTXD/IiBj+P2lDLM//attsU8ltdoP652+rcTFJLKdcC+uFdNGWTzxcD5kjYqbSqFLexOfG7dw4oZjmhFRYzbUcCXyOtXEJUvSzrSKlEQinH7BH5iakg2LdkV+/U9TGdiAkWnWXZjvRM4O92Oyr9THkSwGl7lJMYP2rq4ZwVMT84sCOLhjDfijQDfT2nCSD2WjPEHlu8DZ5vZY6mv2h3c6JsjcIkwwqH8rzx2kaoE2TzY41gLVxlUbjgtfA/gDhWlzrjtsO0rKwpJ5WqcqMxnPFHZFj+WduMGRGXQzG7CicpjuLqxRo+Rvo9gCP8ZP6Movu1BfL5/VdJHq0QFV1kOJqJyDPmQuxotYqJOOzH9Bme+IfCOuBccs5ldix/xW7oKf1DSLLJqbFpA2WNrbTLRizpfaGa3p0kV+20EfBD3ZAqXvTFcbdQtPI337+L0ux75lMVu913kN79yf1pzPMsLhaRyBR7Z9jEyURnFJZWfFhL5YDHHhszsRtzV/PKU5bTUea+ECAeLjwPfwIlDaFpGgWMlfbAkKulbD2bgSOArZGeQ+vtoAeMISqGqugTfnR2crPBd26XNILjsE4q8xvBw7HunQZpOUkq09R24XjyM8cL3fwBL1VGj8jPq/5bsimvAlWb2uyQid0Md8wjjjx6dDazfKxtFGpMqwVoVog23hYLjvQ4P6RGSipHVX2fJPQbDJhXvDZjZr83s+HSvXpj6gApxOBw/9TS0EbFGHS/p0DROM+K9glH+ZGKWp63xe7qikYQSXPq3ye6nAl4O7BNiPVkCORW4i/Fnnn9Y4/etLFcouwrPxo+vhWxkv8b8cKUgEqHKeiceqLEMtfL19NvpYh+Ly2/IoT5CdXhQ6n9L9o/BFm0n5TVY2FBGJL0U2Jm8+Anfjd5Sm4p8e30td4akICpX4uqvJxmv/nolriKO0/+CqIzFOCyfmq+6KIkK8CF8Z3lpEx7F47Xtl9TBM8p3Wx0zuX2zH9/DUJe0PoNJOOj996psMJ4j6V65x1Mcy3lZJU18RHH8aByvOirpVamjl/sHVdTzfame5XGYcQTsoLLhezVJN6Xn0fZrU5qO2xN5SNpGfmTrmPKxtI9Lel2nZTQoc1tJ1xdlxXGnH03PV+hw7Zr4CODFcltYt46L3S2NkSr9+IP0fKpNdF1FUa8vF+2VpDuVj8ntWn2KudvrI4DP67TuKo4il3RyyndY+UjhUUlvTc9XKluiJj8C+NW9KneZgS+M809I+i/crzukjT0kvQb4VapwSCAnAUeSw98PAR8xs0P7+XE1grJ0MiPVMVyFh4DrcT14qfsekfROXHVXislfKA2wncBy5IGb8QO6tiOHV5kDXCzfOHorrn78c1GPpU0jq+KqfRzSx8a4f/z6+AbVGZV3RoFz0ztTSpPKIf//Gg/5H1JetxH5/szMTotye1BO0ygklZ9LOgQPhjqLLKkcKulOM/uU/FC6kVrNtXwR31kigu/D47Ptz3jX4NMlHWDuOjzDWojurRwccl3gX+mdij++2RHgaDO7L8puMZ/4Vv9Z0t00F2S2GcT3emXDp0HZJW2UuLGxghs5O9Kk36CExxccRqTfQctZSinq9+4GlPrv0rMhZelkTUl3FW0Yk3RjSmfdIpBFvQ5OdQlud1S9Q0iPwQV+pqxLC3W+qod1LHFWs/VTjyWUBuW8VXkelZLKV6PO6gMzpVpCaarO8m93tqQLUv7xrY2lcXxLK3WPfNPvC5qd0F3A7qnMSb8JNZZQeo2zG3Ze4f54v6QTgY+lR2P4XpPXWd5dLfmgfxV4N74LO6SUz5nZW7ScpBRl6WR14DNkrn4QuAP4H6UzX8g76N+Pb0oLfavhLohEmm7UzfKmqtMkbQ38C5mDGMO9TEQOWrn01SmyroaWiPoOkc9GGQBOtLx7uFXu/1E8RlivQq/E/JnXxruxs32EzNV1DZYDE54l6WDgB+TIA4uAIyUttP5HEyjbHVJTrzFS/HbK7Y4yfty6tgfJ8l6TRWnMzsKP3IhvzIAfSNrXzK5Q6xJxBIfs9TpntB6KKNaAOO6a9Hc3Jf6QUB6fuBaZqm8i6QmNl1KuVebo41RBJH07PR+WU8RR+dkZ/dxJWrYhuLfDU71K6eT9kSa1wSQ9S9L9Gs9x3qh0pnwvCKMyl/YaST+UNK8d1qAFXCPpfanMpTrmJusa43xlj+sYOKMsd4q6heTw+Qb5bBztbX2EJiwv5taB8m+jipPltrieSudFu79eKf9huRNKrySU7Ru0+ZiyTk3kFXN/lqQHK3ld3sO6ryHpsgnm3JvVpFZFy0dC2TOV2ayEsk8f63bGhOJdIaXcKz8T5Ugy57A9HmblZI2XUr6Ix/5ak2wTOEbS9uTovX3RKyufNrkBfn5HKZ3cinMkIZ3EAWJH4ntuQjoB+LyZLVGP4pOFV4mZXQVcJenZeByuPfGYXDvj+1OGcbfi1dIVgegCS1Kap8kcw0LgWuBB4D7gYjO7IfqnDbtElPdd/KiD0EV326NPeFsvrpQ7GaL8q4DjcWkBvF+eaCGfplDYVE6XtB++52SE3PdrAHPM7MEez/syAvhsstR4L972biPacR/wLXKbZwA/Sc+a+k4sb+Bdgoegf376ewgfR+ienr+UVBbIjfGfxu0qwb3PBDZP9Womy0j0WKr/DPIm79BuiNbrX9VIxFo6jMeKg6m/tyjzdnxbRNSpU1TzCA3HAHDR5DXKnPuz5RxP6BtHJd0naZ0iTVDE0OWW0sA/pmd98yQq6vPNBvU5NOqjLGVtJWmBsnQyJufmh9QHG5Bc574M15HqNlNu6J0laW1Jz5e0paQt0rWlpOekZ7NS+pmN8ouyet2eVQX9mBs1ugtNow3XKxum7NjgzCV9GN95GtzHIPANMztc+Vx6w7nq63FOP/STT+GeTHfg4U966rFT1Hlb4PfkvTSD+N6PV5M5h5BOzsIj8pbte1Pao9K36MnKZ6ws3STXYX6D5PaPdaPvlQNX9hot11c5gvNSdMvuNUmZDfuj1+VW6lBtt3o5Z9M8rTImbc+vBn24POoPbbahj8xyS/G8JmlnLzB1vynbSmbJ9zGU3P6YpN1SuqUcthp7VJ2bnvW04yvS0sUN6rtrg/q+tUF9m/Yw6iWUJcDyarSJsVG6mhOrUaPG9EKx8O6WFtvRYuG9IaljYkd3/FYXc8mPue3pIq1sLD0slTlclH9ylB+ER64mukPj1XkLJW2e0tYqjRo1atToJoqF+oQGC/WXI42y58MWkp4sCMqo3JPjWWrSi6KNOpZeFw9Vyp4vtzMERx/eMd9o0J4vpWe1raFGjRo1uo1iIX5WIgyjxYK9RPksj4GC+HyigZRyWnrWVdWXcjydiaSjD6Z0parrDanuJTG5Re5W2NcQGjVq1KixSqFYiA9osGDfILezlIEJZ0r6TXpe7u1Yugeki3ULIvbxBhLHZcoqrpIw3l7ULdLuVba1Ro0aNWr0CMXC/YMGROWbkUZZ/fSiYnEP9dNjkjZLz7sRDiMI3WvkoScirMKIPHTMiyJdkfYnDer/tTK/GhlqcRPkVHn1u8wiv2qk5K5Kos3Uuct9OelJnt0oY4rye1ZOs3mrdyp0azBfhro5fkU5U0UOXzm1JUXj5yjHvCqlj6WG94L4/GODxfuX3figo7MlrSc3rqtSn8NSuqGiPkemZ6UUc71cwqpVXX2A+uiFFgvDFGlWSueLXi22kXejv3tQTt/HphmmcmWdM52grUmgvM9jd+BnjI97tRDYwcxuKgZFwKXAHuRdqUPAcWb290pRftuoh5FjcP0Ej6hb7iP5kZm9IwhJSrcrcBnjd7KOAruZ2dXRtlbrsjJD7sCwCfCAmS2aKn0TeW1nfrzupDv25SFTFpnZo+rCbnN5FII9gU3JO7KvBv5kZk9M9m6T+Q/iceDmm9njE6QxPAr0M520K96TR7pdhxwZoISZ2f1l+lbLmaT8iDy9IzBiZr+dbCxbzDvatj3wlJndMtkaIWlN4FnAPd3aZ1VEFt8B2I0cA28J8HPgd5YP5Op0Xm6I79KPyAaxLsc+vkHgcTN7qpNypjWUVUdfbMDt3yCP2lsa6DeX9JRyxNtI+7b0vGV7SpH3p4s6RLTemyWtq6zmiOjJdzeQYv6mbFMNR9G/B8gl0cPK+y3mFXGb1pB74J1SzKGhIl2oSjeSRy44v3y/1TLTtZbcmy8i2VbxgKQD0zstz4FKncfkxz6My6to/+qpXRe22670XozNv6txLLHAJSocZtopq0HZoQqaLT836CZ1URVUtO14uXo8IuyOy7+YPyfK15MtIl0HZcdYHiDpD5P06+8k7aU2JcCinA3lUUemQkRfntZrVCdG8TgR7dPAa4GdcE5/FHgRcKyZ/XWaBENmdpt8QTqNHBF1DI/4u0vicJqWDlLaEUmvxWN1xdkl4Ge0H2Jm89PkDK7lVJw7LaWkU8zsO2pTSuoE6t+O8ypa2m2Lc8ARBaEbWIyfiLmJpL81sxuVoy0E1gJWx+PCtYuIgvAp4MPALfhJpPfgYy+c+zwMPyfjdPKZ8e3CpqjzAB6LrVt9OTOVeTKZww1u9wX4t3m6pC2BJeqOpBLf3lH4uUEAHzOzo9Oc7paE/ziwLnChpKPMbKmNs7JOzMW5+NU6KUxZ6vo4cHS6/T/AOficGQVeiJ/ceQjw72b2kg6J6CB+BtKTeOTqoXSVktYocF1Us4l29HN3/LiiO3s72y82lUfprdpTjkzpZhTcRMTWKiWaayXNTM+bCgeTfjeX9GjKoyz3b9Pz0m7y7w3K/bWSob7DSbFSoui7OOnyw+X9FvMqJZS7ijF4WB5ccanrd/p7yzSf2o46q8wFXih31th5gnRbSNqlfKfNcjZKbfph+r+RhLJmmoO/bLdd6b3op4jw3XBM5BLKmLJjSkdSSvHNv0gu8T2RroWSnt+lMqJtX9N46et0SatFmmId+HFK95J2yy/yensq636lqBoTpN9P0n+2076yjmnOLJF0Tbt5TSd05LZbRCS+R9IHcEoekSdHgS9KusjM/iAnKgL+HngpsAtZotkeOF/SvsCIJjntLn2AkjQL5yjXY7zE8R9m9m2Nt5t8BDic8Se1PQUcFrrSfkVBjjYkHfHuuM49dKX9wrlJemuVW+1GHcfwSLy3ACcCXwLOkksRX0njFZJbp5Fmo77XAXsD35F0HPBTYJ6ZLQQws1uBW1N/dCPO3FQL2rhTNtsYh0bYWNI8xset2xt4BX52zaNRXIflWPruv4tH130nLvUfi8f625fuzeX4Lr4CbISft7SFpA+Z2ZVpTYn1ptO5MpbWjH9K/x9uZr+QM7ohDUV9ZGZnA2d3UF4gbLhryz1fox1lu+bjNpRJ52axrqyDj0O/EP1ye3dyyxzFEYm6l6eh3Ss/QCokFZP0XDW2ZXwxpZs5QTllnK5Gbst/kJ9BMags8bw+PR8uyhrW9Din5UItH+yQyp904dOyEsrfl/dbbHNw6LPlUskt6f9tJN2a8r9Y0tzivuRHIXdqQ1lD0vcrfTAs6VeSjlWaC+1Cy9pQTkn/N5JQ1pLPx1+VdWyjzBibkPifUZ7bS1IfBz5U1rODdkaZ/5Dy/W7x7JJ0791l2g7L+WrK853p/4hkPqq0ly3d/990/8Xp/5baWYzNXLm0dY98rZrQJqQJooO3UGbMmY0lPaLJ8emUdtI+LfLcbor8eoXLurWxMM5jP0bSTsCBZDvJxsClknZLdpSZZna3pHcAl5NPEhwGPiHpbjM7XhWbhnxgLUkU3wAOLcow/HS/g8zsmVTGEknbAD8kc22jOFf1BTO7SC2eId1FBMfzUeDZ9FdCMfwse+icW223/Jj4s83sBkmvwjnc9wC/lZ9Z/+sifXsFZa5/AfAuSV8Atk7lzMbtfq8CPirpZzgHfC/tR8SOubi1siS9VPqQf/DDKV147HQqFUX//Jw8rwzYB2/3AWmud+SBpXy+0Ob46acAr079NobbawC+Knc4eLjTMsknQq6V+vGTkn4BnAKcIA9M+yGy7ahTp4MxvA/XSNeTNLCppbEd66JWYzZ+ZtGXybblWK9WA35R1G8yRH1uxm1n/UKsXw92L8e8P2VI0hWJYoVkILnn1wYp7az0+1fpWZw/Eh5aH03Px3n/yLmCz6Y0cXZ9SCh7VvJ+nqQ/p7SlFPSj9Ly2m0wB9UZCWV3Okd2iylkzkj5ccDs/Tr9XlO93E/K9Sy+RdE4q61PpfkvtU5aEVpd7PA3LXZSX2g+VJeY903w8tZ2yijKrNpSZlefxnRyf/u9IEi/Ki766Xx4f7+l0PaLMaZ/USZlFWV9K+X0g/R8nUG4m6Rfp2W8l/T6tBS9Lz9uyg6UxPDPl+7ni2WB5Ffef0077yjrKpdphSb+eIv2qt1ZVOqlUaYVK6gq5z/hStZakj6VnQVQibWlYrx61WcYRk/JCF8RkY/nRvaqku0LpWNbpMEDKRLLfV1NtV/6w35P6vBsEZTW52/CNRf4D8aFKep3Gb1DtxCgfeX5E0ieVGJoG6T6ZyvtcB+2Lthyb8jpP0pxKmufLF0ApH/LW6aL7rdRPG6ZvJQ5jG1J2e31dh2VFP7435Xe5fGNzqIViN/lzJd2Z0rQdwqho2+dT294X94u6rKas7pOcwdw+PevEsWI7eXQNSfqMpPUapJ0j6Wh14FhRlLehXF153VTvtJB3uHX3++r+Rs9iwF8m10dK4yWESyWtkdIEUYmPsJQ6JOkv0vOl+kxJh2r8fpNPpjQlMYkPqSQm90naJKWpd7g2geLDfn/qwyPK+y3mVRKUp+WeXoOVZ1HesyWdncr8eZmmzfqfmPJ6WM6B/puko+SL8a/SsyckvVTt7ysIKWUDZWbmXkn/IekLkv5beaE6NeZ0q+U0aNt/pjxDIiqJ8x7p2Tz5wtWyvab47uJE08XK3lTL7JSXdHDR9g3aLDPadkzK64OV+6VU+4E0n6QOJJTyPbkUGWfcz5PbaI6VE5EfyRkiSTq73fKKsjZNfSr5uvUnedSOP6a//yjpNknHpvTTeh9KT1BM6F2KwS6Jyk/lhlJTDiN/anpWqr8Wyz2/qpLKAXLic0z6PwjTJpL+L+VTEpN5kl5e1q3G1CjGcS+5ynL/8n6LeS0lGpIuki/sy3yIZd7yxbgjo3z6faGcqMzTslgiV+O8PKXtZJGP8p4t6XtylVCJ+yR9tpq+zbJibI5KYxPODAOV55+XOz28vbzfRjkfkKvzPl65Xx7oFve+Jd9Y/JYOy3xv+p6XcaCplPcaeRDal5d90A6K/ttE7gQQmpbqOB4tJwbtOlXEXFlHrjm5QS7d3ZF+70rXben/iJO4aq5fytzErspntZdE5WJl9dOQnGO7KD0LohIf/Fsjz2ISvVgaFy9s4zQo8X4Qk0eU9h+ssoOxgkGFSlKJ8+5SvutJ2lZuN9lV7km2afG8G7u8S659biprp1RWSOZdjWM2UX6VunRt7k9W90qZ/QhOGevBbCUtRRfyLCWgmfI9Ny+RtHX6XaMb5dRoEcrSx/6JQFQ3Pp6pbMwfTAQmXGnD7TgIRLgjLlUVFJNp04KYlJLJg8p61X6d+bzSoVjc+2p36lZ5KtRAkzzv2uKnSYJR9pup6fai3kx+3Sqz2XnXC8I12Rim53116un3tzdtUUgQBymf614SlZ8oe28MylVh5xfpghBJ0ntTuhnKaq7NJiAmd0t6aeS7nJpfo0P0gJMvz+vpaYj3CrM0LRxBVlb0qm8rc2blDiW/oqAgKgdXiEos/j9TodqQ9LmCQEjjDfXvK9JtpbwpriQmtymfCV8Tkxo1atRYmVAQlbcXC38pqdyVCMRXCwIRvyGpxL2/lHuRPVikiWd3SnpBWWaNGjVq1FjJUBCVt8iDyQVRCWLwVCGRlBsdg2iUgeIWNHj/PklblWXVqFGjRo2VFAVR2VPZpbgkFkFMgkgcI48y2oiojClLOPdK2jblXau5atSoUWNVQEFUdlMOYlfuPwnJJIJFDsp924OohAosiMlNyofr1MSkRo0aNVYlFERlW+XNiOWJev8Q6ZTdhD9RPA9icplyjLCamNSoUaPGqgjlfSTrKYfaeFB5d3y5Gzf+fr889o3kYRBml2lr1KhRo8YqioJQDMpDbeyU/h+qpCtP89tP0meKZ3Vsrho1atRYzvj/vvno4s3e5kAAAAAASUVORK5CYII="} alt="Sentinel Insurance" style={{ height: 36 }} /><div style={{ fontSize: 10, color: "#64748b", fontWeight: 500 }}>{"Service & Sales Management"}</div></div>
        <nav style={st.nav}>
          {NAV_ITEMS.map(function(item) {
            var IconComp = item.Icon;
            var active = view === item.key || (item.key === "clients" && view === "client-detail") || (item.key === "pipeline" && view === "prospect-detail");
            return (
              <button key={item.key} style={st.navBtn(active)} onClick={function() { setView(item.key); setSelectedClientId(null); setSelectedProspectId(null); setSearchTerm(""); setEmailMenuFor(null); }}>
                <span style={{ display: "flex", alignItems: "center", gap: 5 }}><IconComp size={13} /> {item.label}</span>
              </button>
            );
          })}
        </nav>
      </header>

      <main style={st.main}>
        {view === "dashboard" && <Dashboard />}
        {view === "clients" && <ClientsList />}
        {view === "client-detail" && <ClientDetail />}
        {view === "pipeline" && <PipelineView />}
        {view === "prospect-detail" && <ProspectDetail />}
        {view === "calendar" && <CalendarView />}
        {view === "reports" && <ReportsView />}
      </main>

      {modal === "add-client" && <ClientForm onSave={addClient} />}
      {modal === "edit-client" && editItem && <ClientForm client={editItem} onSave={updateClient} />}
      {modal === "add-policy" && <PolicyForm clientId={selectedClientId} onSave={addPolicy} />}
      {modal === "edit-policy" && editItem && <PolicyForm policy={editItem} clientId={selectedClientId} onSave={updatePolicy} />}
      {modal === "add-activity-client" && <ActivityForm clientId={selectedClientId} />}
      {modal === "add-activity-prospect" && <ActivityForm prospectId={selectedProspectId} />}
      {modal === "add-followup" && <FollowUpForm clientId={selectedClientId} />}
      {modal === "add-document" && <DocumentForm clientId={selectedClientId} />}
      {modal === "start-workflow" && (
        <ModalWrap title="Start Renewal Workflow">
          <p style={{ fontSize: 13, color: "#94a3b8", marginBottom: 14 }}>{"Select a commercial policy to start a 150-day renewal marketing workflow:"}</p>
          <div style={{ display: "grid", gap: 8 }}>
            {clientPolicies.filter(function(p) { return p.status === "active" && p.expirationDate; }).map(function(p) {
              var existing = (data.renewalWorkflows || []).find(function(w) { return w.policyId === p.id; });
              return (
                <button key={p.id} disabled={!!existing} onClick={function() { addRenewalWorkflow(p.id); setModal(null); }} style={{ ...st.row, justifyContent: "space-between", border: "1px solid #1e293b", cursor: existing ? "default" : "pointer", opacity: existing ? 0.4 : 1 }}>
                  <div><div style={{ fontSize: 14, fontWeight: 600, color: "#e2e8f0" }}>{p.coverageType + " - " + p.carrier}</div><div style={{ fontSize: 11, color: "#64748b" }}>{"Exp: " + formatDateShort(p.expirationDate) + " (" + String(daysUntil(p.expirationDate)) + " days)"}</div></div>
                  <span style={{ fontSize: 11, color: existing ? "#64748b" : "#f59e0b" }}>{existing ? "Already started" : "Start \u2192"}</span>
                </button>
              );
            })}
          </div>
        </ModalWrap>
      )}
      {modal === "add-prospect" && <ProspectForm onSave={addProspect} />}
      {modal === "edit-prospect" && editItem && <ProspectForm prospect={editItem} onSave={updateProspect} />}
      {modal === "export" && <ExportModal />}
      {modal === "import" && <ImportModal />}
    </div>
  );
}

    ReactDOM.createRoot(document.getElementById('root')).render(<PasswordGate><SentinelCRM /></PasswordGate>);
  </script>
</body>
</html>
